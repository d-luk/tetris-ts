!function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function o(t){M+=t,s()}function r(){M=0,s()}function i(t,e){void 0===e&&(e=!1),R.push(t),e&&t(M)}function s(){R.forEach(function(t){return t(M)})}function a(t,e){var n={width:t.size.width/e.width,height:t.size.height/e.height},o=t.ctx;o.strokeStyle="#efefef",o.lineWidth=t.pixelRatio;for(var r=0;r<t.size.width;r+=n.width)o.beginPath(),o.moveTo(r,0),o.lineTo(r,t.size.height),o.stroke();for(var i=0;i<t.size.height;i+=n.height)o.beginPath(),o.moveTo(0,i),o.lineTo(t.size.width,i),o.stroke()}function c(t){switch(t){case 1:return"#ffeb3b";case 2:return"#03a9f4";case 3:return"#f44336";case 4:return"#4caf50";case 5:return"#ff9800";case 6:return"#fbafbc";case 7:return"#9c27b0";case 8:return"#e0e0e0";default:return"#000"}}function u(t,e){var n=t.ctx,o={width:t.size.width/e.length,height:t.size.height/e[0].length};e.forEach(function(t,e){return t.forEach(function(t,r){void 0!==t&&(B.debug.drawEmptyTiles||t)&&(n.fillStyle=t?c(t):F,n.fillRect(e*o.width|0,r*o.height|0,Math.ceil(o.width),Math.ceil(o.height)))})})}function f(t){return{x:t.x,y:t.y}}function h(t,e){return t.x===e.x&&t.y===e.y}function p(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n))return n}function l(t,e){return void 0!==p(t,e)}function d(t){for(var e=[],n=0;n<t.width;n++)e[n]=new Array(t.height);return e}function y(t){return t.reduce(function(t,e,n){return t[n]=e.slice(),t},[])}function v(t){return{width:t.length,height:t[0].length}}function _(t,e){return t.length===e.length&&t[0].length===e[0].length&&!l(t,function(t,n){return l(t,function(t,o){return t!==e[n][o]})})}function g(t,e,n){void 0===n&&(n=y(t));for(var o=e.matrix,r=e.position,i=n,s=0;s<o.length;s++)for(var a=0;a<o[0].length;a++){var c=o[s][a];if(void 0!==c){var u=s+r.x,f=a+r.y;u>=0&&u<t.length&&f>=0&&f<t[0].length&&(c||!i[u][f])&&(i[u][f]=c)}}return i}function b(t){return w(t).reduce(function(t,e,n){return t[n]=e.reverse(),t},[])}function w(t,e){void 0===e&&(e=!1);for(var n=t.length,o=d({width:n,height:n}),r=0;r<n;r++)for(var i=0;i<n;i++)o[r][i]=e?t[n-i-1][r]:t[i][n-r-1];return o}function x(t,e){for(var n=e.matrix,o=e.position,r=0;r<n.length;r++)for(var i=n[r],s=0;s<i.length;s++)if(i[s]){var a=r+o.x,c=s+o.y;if(a<0||a>=t.length||c<0||c>=t[0].length)return!1}return!0}function m(t,e){for(var n=e.matrix,o=e.position,r=0;r<n.length;r++)for(var i=0;i<n[0].length;i++)if(n[r][i]){var s=t[r+o.x];if(s&&s[i+o.y])return!0}return!1}function k(t,e){for(var n=t.matrix,o=t.position,r=Math.ceil(n.length/2),i=1;i<=r;i++){var s=f(o);if(s.y+=i,!e({matrix:n,position:s}))return s;if(s.y-=2*i,!e({matrix:n,position:s}))return s;if(s.y+=i,s.x+=i,!e({matrix:n,position:s}))return s;if(s.x-=2*i,!e({matrix:n,position:s}))return s;s.x+=i}return null}function O(t,e){var n=e.matrix,o=f(e.position),r=o.y;do{r++}while(!t.collides({matrix:n,position:{x:o.x,y:r}}));return o.y=r-1,{matrix:n.map(function(t){return t.map(function(t){if(t)return V})}),position:o}}function P(){var t={matrix:St.shape.blocks,position:St.position},e=O(Lt,t);return g(g(Lt.blocks,e),t)}function T(){X.remove("ArrowDown")}function j(t,e){var n={x:St.position.x,y:St.position.y},r=y(St.shape.blocks),i=!0,s=!1;switch(t){case"ArrowUp":if(e)return!0;St.shape.rotate();var a={matrix:St.shape.blocks,position:n};if(Lt.collides(a)){var c=k(a,Lt.collides.bind(Lt));c?n=c:St.shape.rotate(!0)}break;case"ArrowRight":n.x++;break;case"ArrowDown":n.y++;var u=B.points.softDrop;St.softDropPoints+=u,St.softDropPoints<B.points.softDropMax&&o(u);break;case"ArrowLeft":n.x--;break;case"Space":if(e)return!0;var f=n,p=0;do{f={x:f.x,y:f.y+1},p+=B.points.hardDrop}while(!Lt.collides({matrix:St.shape.blocks,position:f}));n={x:f.x,y:f.y-1},o(Math.min(p-B.points.hardDrop,B.points.hardDropMax)),s=!0;break;default:i=!1}var l=!h(St.position,n);if(l||s){var d={matrix:St.shape.blocks,position:n};Lt.collides(d)?l=!1:St.position=n,(s||"ArrowDown"===t&&Lt.collides(d))&&A()}var v=!_(St.shape.blocks,r);return(l||v)&&(D(),It.draw(P())),i}function z(){return new(0,Ct[Math.floor(Math.random()*Ct.length)])}function C(){Lt.clear(),St.reset(),r()}function A(){Lt.place(St.shape,St.position);var t=Lt.clearFullLines();t&&o(B.points.linesCleared[t]),St.reset(),Lt.collides({matrix:St.shape.blocks,position:St.position})&&C()}function D(){Mt.stop()}function E(){var t={x:St.position.x,y:St.position.y+1};Lt.collides({matrix:St.shape.blocks,position:t})?Mt.start():St.position=t,It.draw(P())}Object.defineProperty(e,"__esModule",{value:!0});var S,I,L,M=0,R=[],N={gameSpeed:.4,points:{linesCleared:{1:40,2:100,3:300,4:1200},softDrop:1,hardDrop:2,softDropMax:20,hardDropMax:40},placementTimeout:.5,debug:{drawEmptyTiles:!1,emptyTileColor:"#f1f1f1"}},B=N,F=B.debug.emptyTileColor,W=function(){function t(t){var e=document.getElementById(t);this.pixelRatio=devicePixelRatio||1,this.size={width:parseInt(e.getAttribute("width"),10)*this.pixelRatio,height:parseInt(e.getAttribute("height"),10)*this.pixelRatio},this.size.width!==e.offsetWidth&&e.setAttribute("width",""+this.size.width),this.size.height!==e.offsetHeight&&e.setAttribute("height",""+this.size.height);var n=e.getContext("2d");if(!n)throw new Error("Context not found!");this.ctx=n}return t.prototype.draw=function(t){this.clear(),a(this,v(t)),u(this,t)},t.prototype.clear=function(){this.ctx.clearRect(0,0,this.size.width,this.size.height)},t}(),q=W,H=function(){function t(t){this.size=t,this.clear()}return Object.defineProperty(t.prototype,"blocks",{get:function(){return this._blocks},enumerable:!0,configurable:!0}),t.prototype.place=function(t,e){g(this.blocks,{matrix:t.blocks,position:e},this.blocks)},t.prototype.clearFullLines=function(){var t=this,e=this.getFullLines();return e.forEach(function(e){return t.deleteRow(e)}),e.length},t.prototype.getFullLines=function(){var t=this._blocks[0].length,e=new Array(t-1);t:for(var n=0;n<t;n++)for(var o=0,r=this._blocks;o<r.length;o++){var i=r[o];if(!i[n]){e[n]=!0;continue t}}for(var s=[],a=0;a<t;a++)e[a]||s.push(a);return s},t.prototype.deleteRow=function(t){this._blocks.forEach(function(e){e.splice(t,1),e.unshift(void 0)})},t.prototype.clear=function(){this._blocks=[];for(var t=0;t<this.size.width;t++)this._blocks[t]=new Array(this.size.height)},t.prototype.contains=function(t){return x(this._blocks,t)},t.prototype.collides=function(t){return!this.contains(t)||m(this.blocks,t)},t}(),G=H,J=function(){function t(t,e,n){void 0===n&&(n=!0),this._running=!1,this._handler=t,this._interval=e,this._repeat=n}return Object.defineProperty(t.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),t.prototype.start=function(t){var e=this;void 0===t&&(t=!1),t&&(this._handler(),!this._repeat)||(this.stop(),this._handle=(this._repeat?setInterval:setTimeout)(function(){e._handler(),e._running=!1},this._interval),this._running=!0)},t.prototype.stop=function(){this._handle=(this._repeat?clearInterval:clearTimeout)(this._handle),this._running=!1},t}(),U=J,K=function(){function t(){this._array=[]}return Object.defineProperty(t.prototype,"count",{get:function(){return this._array.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this._array},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this.contains(t)||this._array.push(t)},t.prototype.remove=function(t){var e=this._array.indexOf(t);e>=0&&this._array.splice(e,1)},t.prototype.contains=function(t){return this._array.indexOf(t)>=0},t}(),Q=K,V=8,X=new Q,Y=new U(function(){X.values.forEach(function(t){j(t,!0)})},90),Z=new U(function(){Y.start()},200,!1),$=function(){function t(t){this._blocks=t}return Object.defineProperty(t.prototype,"blocks",{get:function(){return this._blocks},enumerable:!0,configurable:!0}),t.prototype.rotate=function(t){void 0===t&&(t=!1),this._blocks=w(this._blocks,t)},t}(),tt=$,et=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nt=2,ot=function(t){function e(){return t.call(this,b([[0,nt,0,0],[0,nt,0,0],[0,nt,0,0],[0,nt,0,0]]))||this}return et(e,t),e}(tt),rt=ot,it=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),st=6,at=function(t){function e(){return t.call(this,b([[0,st,0],[0,st,0],[st,st,0]]))||this}return it(e,t),e}(tt),ct=at,ut=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ft=5,ht=function(t){function e(){return t.call(this,b([[0,ft,0],[0,ft,0],[0,ft,ft]]))||this}return ut(e,t),e}(tt),pt=ht,lt=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dt=1,yt=function(t){function e(){return t.call(this,b([[dt,dt],[dt,dt]]))||this}return lt(e,t),e}(tt),vt=yt,_t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),gt=3,bt=function(t){function e(){return t.call(this,b([[0,gt,gt],[gt,gt,0],[0,0,0]]))||this}return _t(e,t),e}(tt),wt=bt,xt=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),mt=7,kt=function(t){function e(){return t.call(this,b([[mt,mt,mt],[0,mt,0],[0,0,0]]))||this}return xt(e,t),e}(tt),Ot=kt,Pt=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Tt=4,jt=function(t){function e(){return t.call(this,b([[Tt,Tt,0],[0,Tt,Tt],[0,0,0]]))||this}return Pt(e,t),e}(tt),zt=jt,Ct=[rt,ct,pt,vt,wt,Ot,zt],At=function(){function t(t){this.softDropPoints=0,this._startingPos=t,this.reset()}return Object.defineProperty(t.prototype,"shape",{get:function(){return this._shape},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this.position=f(this._startingPos),this._shape=z(),T(),this.softDropPoints=0},t}(),Dt=At,Et={width:10,height:20},St=new Dt({x:Et.width/2-1,y:0}),It=new q("game"),Lt=new G(Et),Mt=new U(A,1e3*B.placementTimeout,!1);n(1),function(t){L=t,window.clearInterval(I),E(),I=window.setInterval(function(){Mt.running||E()},1e3*t)}(B.gameSpeed),function(){document.addEventListener("keydown",function(t){if(!t.repeat){var e=t.code;j(e,!1)&&(t.preventDefault(),X.add(e),"ArrowLeft"===e||"ArrowRight"===e?(Y.stop(),Z.start()):Y.start())}}),document.addEventListener("keyup",function(t){X.contains(t.code)&&(X.remove(t.code),0===X.count&&(Z.stop(),Y.stop()))})}(),function(){S=document.getElementById("player-score"),i(function(t){S.textContent=t.toLocaleString()},!0)}()},function(t,e){/*! modernizr 3.5.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-canvas-localstorage-serviceworker-sessionstorage-touchevents-webgl !*/
!function(t,e,n){function o(t,e){return typeof t===e}function r(){return"function"!=typeof e.createElement?e.createElement(arguments[0]):p?e.createElementNS.call(e,"http://www.w3.org/2000/svg",arguments[0]):e.createElement.apply(e,arguments)}function i(){var t=e.body;return t||(t=r(p?"svg":"body"),t.fake=!0),t}function s(t,n,o,s){var a,c,u,f,p="modernizr",l=r("div"),d=i();if(parseInt(o,10))for(;o--;)u=r("div"),u.id=s?s[o]:p+(o+1),l.appendChild(u);return a=r("style"),a.type="text/css",a.id="s"+p,(d.fake?d:l).appendChild(a),d.appendChild(l),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(e.createTextNode(t)),l.id=p,d.fake&&(d.style.background="",d.style.overflow="hidden",f=h.style.overflow,h.style.overflow="hidden",h.appendChild(d)),c=n(l,t),d.fake?(d.parentNode.removeChild(d),h.style.overflow=f,h.offsetHeight):l.parentNode.removeChild(l),!!c}var a=[],c={_version:"3.5.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(t,e){var n=this;setTimeout(function(){e(n[t])},0)},addTest:function(t,e,n){a.push({name:t,fn:e,options:n})},addAsyncTest:function(t){a.push({name:null,fn:t})}},u=function(){};u.prototype=c,u=new u,u.addTest("serviceworker","serviceWorker"in navigator),u.addTest("localstorage",function(){var t="modernizr";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}),u.addTest("sessionstorage",function(){var t="modernizr";try{return sessionStorage.setItem(t,t),sessionStorage.removeItem(t),!0}catch(t){return!1}});var f=[],h=e.documentElement,p="svg"===h.nodeName.toLowerCase();u.addTest("canvas",function(){var t=r("canvas");return!(!t.getContext||!t.getContext("2d"))}),u.addTest("webgl",function(){var e=r("canvas"),n="probablySupportsContext"in e?"probablySupportsContext":"supportsContext";return n in e?e[n]("webgl")||e[n]("experimental-webgl"):"WebGLRenderingContext"in t});var l=c._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];c._prefixes=l;var d=c.testStyles=s;u.addTest("touchevents",function(){var n;if("ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch)n=!0;else{var o=["@media (",l.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");d(o,function(t){n=9===t.offsetTop})}return n}),function(){var t,e,n,r,i,s,c;for(var h in a)if(a.hasOwnProperty(h)){if(t=[],e=a[h],e.name&&(t.push(e.name.toLowerCase()),e.options&&e.options.aliases&&e.options.aliases.length))for(n=0;n<e.options.aliases.length;n++)t.push(e.options.aliases[n].toLowerCase());for(r=o(e.fn,"function")?e.fn():e.fn,i=0;i<t.length;i++)s=t[i],c=s.split("."),1===c.length?u[c[0]]=r:(!u[c[0]]||u[c[0]]instanceof Boolean||(u[c[0]]=new Boolean(u[c[0]])),u[c[0]][c[1]]=r),f.push((r?"":"no-")+c.join("-"))}}(),delete c.addTest,delete c.addAsyncTest;for(var y=0;y<u._q.length;y++)u._q[y]();t.Modernizr=u}(window,document)}]);
//# sourceMappingURL=index.js.map