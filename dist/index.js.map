{"version":3,"sources":["webpack:///index.js","webpack:///webpack/bootstrap d1c1fc96a6197189833b","webpack:///./src/services/player-score.ts","webpack:///./src/interfaces/point.ts","webpack:///./src/services/matrix-calculations.ts","webpack:///./src/services/arrays.ts","webpack:///./src/services/random-shape.ts","webpack:///./src/services/clear-panel.ts","webpack:///./src/services/draw-grid.ts","webpack:///./src/services/draw-matrix.ts","webpack:///./src/index.ts","webpack:///./src/components/player-score.ts","webpack:///./src/models/board.ts","webpack:///./src/models/shape.ts","webpack:///./src/models/shapes/i.ts","webpack:///./src/models/shapes/j.ts","webpack:///./src/models/shapes/l.ts","webpack:///./src/models/shapes/o.ts","webpack:///./src/models/shapes/s.ts","webpack:///./src/models/shapes/t.ts","webpack:///./src/models/shapes/z.ts","webpack:///./src/models/player.ts","webpack:///./src/settings.ts","webpack:///./src/models/panel.ts","webpack:///./src/vendor/modernizr.min.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","addScore","points","currentScore","triggerScoreChange","resetScore","onScoreChange","handler","triggerOnInit","subscribers","push","forEach","clonePoint","point","x","y","pointEquals","a","b","createMatrix","size","result","col","width","Array","height","copyMatrix","matrix","reduce","slice","mergeMatrixes","m1","m2","position","target","length","j","value","addMatrix","source","xyMatrix","rotateMatrix","reverse","matrixContains","parent","child","matrixesColliding","findIndex","array","predicate","findAny","getRandomShape","Shape","shapes","Math","floor","random","clearPanel","panel","ctx","clearRect","drawGrid","gridSize","tileSize","strokeStyle","lineWidth","pixelRatio","beginPath","moveTo","lineTo","stroke","drawMatrix","item","src_settings","drawEmptyTiles","fillStyle","getColorCode","fillRect","color","update","newPos","src_player","src_board","collides","shape","blocks","place","linesCleared","clearFullLines","reset","softDropPoints","gameOver","draw","viewMatrix","src_panel","boardSize","initInterval","window","clearInterval","interval","setInterval","src_s","clear","scoreEl","board_Board","Board","this","_blocks","_this","fullRows","getFullLines","row","deleteRow","rowCount","incompleteRows","rows","splice","unshift","undefined","contains","models_board","shape_Shape","rotate","models_shape","__extends","extendStatics","setPrototypeOf","__proto__","__","constructor","create","i_I","_super","I","j___extends","j_c","j_J","J","l___extends","l_c","l_L","L","o___extends","o_c","o_O","O","s___extends","s_c","s_S","S","t___extends","t_c","t_T","T","t","z___extends","z_c","z_Z","Z","z","player_Player","Player","startingPosition","_startingPos","_shape","getContainedPosition","board","xLow","xHigh","player","settings","1","2","3","4","softDrop","hardDrop","softDropMax","hardDropMax","el","document","getElementById","devicePixelRatio","ctxSize","parseInt","getAttribute","offsetWidth","setAttribute","offsetHeight","canvasID","canvas","Error","getContext","addEventListener","e","newPosition","triggered","code","repeat","sdPoints","nextPos","hdPoints","min","preventDefault","score","textContent","toLocaleString","createElement","arguments","u","createElementNS","apply","body","fake","r","v","id","appendChild","type","styleSheet","cssText","createTextNode","style","background","overflow","f","parentNode","removeChild","_version","_config","classPrefix","enableClasses","enableJSClass","usePrefixes","_q","on","setTimeout","addTest","fn","options","addAsyncTest","Modernizr","navigator","localStorage","setItem","removeItem","sessionStorage","documentElement","nodeName","toLowerCase","split","_prefixes","testStyles","DocumentTouch","join","offsetTop","aliases","Boolean"],"mappings":"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","file":"index.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// CONCATENATED MODULE: ./src/services/player-score.ts\nvar currentScore = 0;\r\nfunction addScore(points) {\r\n    currentScore += points;\r\n    triggerScoreChange();\r\n}\r\nfunction resetScore() {\r\n    currentScore = 0;\r\n    triggerScoreChange();\r\n}\r\nvar subscribers = [];\r\nfunction onScoreChange(handler, triggerOnInit) {\r\n    if (triggerOnInit === void 0) { triggerOnInit = false; }\r\n    subscribers.push(handler);\r\n    if (triggerOnInit)\r\n        handler(currentScore);\r\n}\r\nfunction triggerScoreChange() {\r\n    subscribers.forEach(function (handler) { return handler(currentScore); });\r\n}\r\n\n// CONCATENATED MODULE: ./src/components/player-score.ts\n\r\nvar scoreEl;\r\nfunction loadPlayerScore() {\r\n    scoreEl = document.getElementById('player-score');\r\n    onScoreChange(function (score) {\r\n        scoreEl.textContent = score.toLocaleString();\r\n    }, true);\r\n}\r\n\n// CONCATENATED MODULE: ./src/interfaces/point.ts\nfunction clonePoint(point) {\r\n    return { x: point.x, y: point.y };\r\n}\r\nfunction pointEquals(a, b) {\r\n    return a.x === b.x && a.y === b.y;\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/matrix-calculations.ts\nfunction createMatrix(size) {\r\n    var result = [];\r\n    for (var col = 0; col < size.width; col++) {\r\n        result[col] = new Array(size.height);\r\n    }\r\n    return result;\r\n}\r\nfunction copyMatrix(matrix) {\r\n    return matrix.reduce(function (result, col, x) {\r\n        result[x] = col.slice();\r\n        return result;\r\n    }, []);\r\n}\r\nfunction mergeMatrixes(m1, m2, position, target) {\r\n    var result = target || copyMatrix(m1);\r\n    for (var i = 0; i < m2.length; i++) {\r\n        for (var j = 0; j < m2[0].length; j++) {\r\n            var value = m2[i][j];\r\n            if (typeof value === 'undefined')\r\n                continue;\r\n            var x = i + position.x;\r\n            var y = j + position.y;\r\n            if (x >= 0 && x < m1.length &&\r\n                y >= 0 && y < m1[0].length &&\r\n                (value || !result[x][y])) {\r\n                result[x][y] = value;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction addMatrix(target, source, position) {\r\n    mergeMatrixes(target, source, position, target);\r\n}\r\nfunction xyMatrix(matrix) {\r\n    return rotateMatrix(matrix)\r\n        .reduce(function (result, col, x) {\r\n        result[x] = col.reverse();\r\n        return result;\r\n    }, []);\r\n}\r\nfunction rotateMatrix(matrix, reverse) {\r\n    if (reverse === void 0) { reverse = false; }\r\n    var l = matrix.length;\r\n    var result = createMatrix({ width: l, height: l });\r\n    for (var x = 0; x < l; x++) {\r\n        for (var y = 0; y < l; y++) {\r\n            result[x][y] = reverse\r\n                ? matrix[l - y - 1][x]\r\n                : matrix[y][l - x - 1];\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction matrixContains(parent, child, position) {\r\n    for (var i = 0; i < child.length; i++) {\r\n        var col = child[i];\r\n        for (var j = 0; j < col.length; j++) {\r\n            if (!col[j])\r\n                continue;\r\n            var x = i + position.x;\r\n            var y = j + position.y;\r\n            if (x < 0 || x >= parent.length ||\r\n                y < 0 || y >= parent[0].length) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction matrixesColliding(m1, m2, position) {\r\n    for (var x = 0; x < m2.length; x++) {\r\n        for (var y = 0; y < m2[0].length; y++) {\r\n            if (!m2[x][y])\r\n                continue;\r\n            if (m1[x + position.x][y + position.y]) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\n// CONCATENATED MODULE: ./src/models/board.ts\n\r\nvar board_Board = (function () {\r\n    function Board(size) {\r\n        this.size = size;\r\n        this.clear();\r\n    }\r\n    Object.defineProperty(Board.prototype, \"blocks\", {\r\n        get: function () { return this._blocks; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Board.prototype.place = function (shape, position) {\r\n        addMatrix(this.blocks, shape.blocks, position);\r\n    };\r\n    Board.prototype.clearFullLines = function () {\r\n        var _this = this;\r\n        var fullRows = this.getFullLines();\r\n        fullRows.forEach(function (row) { return _this.deleteRow(row); });\r\n        return fullRows.length;\r\n    };\r\n    Board.prototype.getFullLines = function () {\r\n        var rowCount = this._blocks[0].length;\r\n        var incompleteRows = new Array(rowCount - 1);\r\n        rows: for (var y = 0; y < rowCount; y++) {\r\n            for (var x = 0; x < this._blocks.length; x++) {\r\n                if (!this._blocks[x][y]) {\r\n                    incompleteRows[y] = true;\r\n                    continue rows;\r\n                }\r\n            }\r\n        }\r\n        var result = [];\r\n        for (var row = 0; row < rowCount; row++) {\r\n            if (!incompleteRows[row])\r\n                result.push(row);\r\n        }\r\n        return result;\r\n    };\r\n    Board.prototype.deleteRow = function (row) {\r\n        this._blocks.forEach(function (col) {\r\n            col.splice(row, 1);\r\n            col.unshift(undefined);\r\n        });\r\n    };\r\n    Board.prototype.clear = function () {\r\n        this._blocks = [];\r\n        for (var x = 0; x < this.size.width; x++) {\r\n            this._blocks[x] = new Array(this.size.height);\r\n        }\r\n    };\r\n    Board.prototype.contains = function (matrix, position) {\r\n        return matrixContains(this._blocks, matrix, position);\r\n    };\r\n    Board.prototype.collides = function (matrix, position) {\r\n        return !this.contains(matrix, position)\r\n            || matrixesColliding(this.blocks, matrix, position);\r\n    };\r\n    return Board;\r\n}());\r\n/* harmony default export */ var models_board = (board_Board);\r\n\n// CONCATENATED MODULE: ./src/models/panel.ts\nfunction getPanel(canvasID, size, pixelRatio) {\r\n    var canvas = document.getElementById(canvasID);\r\n    if (!canvas)\r\n        throw new Error('Canvas not found!');\r\n    var ctx = canvas.getContext('2d');\r\n    if (!ctx)\r\n        throw new Error('Context not found!');\r\n    return { ctx: ctx, size: size, pixelRatio: pixelRatio };\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/arrays.ts\nfunction findIndex(array, predicate) {\r\n    for (var i = 0; i < array.length; i++) {\r\n        var value = array[i];\r\n        if (predicate(value, i)) {\r\n            return i;\r\n        }\r\n    }\r\n}\r\nfunction findAny(array, predicate) {\r\n    return typeof findIndex(array, predicate) !== 'undefined';\r\n}\r\n\n// CONCATENATED MODULE: ./src/models/shape.ts\n\r\nvar shape_Shape = (function () {\r\n    function Shape(blocks) {\r\n        this._blocks = blocks;\r\n    }\r\n    Object.defineProperty(Shape.prototype, \"blocks\", {\r\n        get: function () {\r\n            return this._blocks;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Shape.prototype.rotate = function (reverse) {\r\n        if (reverse === void 0) { reverse = false; }\r\n        this._blocks = rotateMatrix(this._blocks, reverse);\r\n    };\r\n    return Shape;\r\n}());\r\n/* harmony default export */ var models_shape = (shape_Shape);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/i.ts\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar c = 2;\r\nvar i_I = (function (_super) {\r\n    __extends(I, _super);\r\n    function I() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return I;\r\n}(models_shape));\r\n/* harmony default export */ var i = (i_I);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/j.ts\nvar j___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar j_c = 6;\r\nvar j_J = (function (_super) {\r\n    j___extends(J, _super);\r\n    function J() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, j_c, 0],\r\n            [0, j_c, 0],\r\n            [j_c, j_c, 0]\r\n        ])) || this;\r\n    }\r\n    return J;\r\n}(models_shape));\r\n/* harmony default export */ var j = (j_J);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/l.ts\nvar l___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar l_c = 5;\r\nvar l_L = (function (_super) {\r\n    l___extends(L, _super);\r\n    function L() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, l_c, 0],\r\n            [0, l_c, 0],\r\n            [0, l_c, l_c]\r\n        ])) || this;\r\n    }\r\n    return L;\r\n}(models_shape));\r\n/* harmony default export */ var l = (l_L);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/o.ts\nvar o___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar o_c = 1;\r\nvar o_O = (function (_super) {\r\n    o___extends(O, _super);\r\n    function O() {\r\n        return _super.call(this, xyMatrix([\r\n            [o_c, o_c],\r\n            [o_c, o_c]\r\n        ])) || this;\r\n    }\r\n    return O;\r\n}(models_shape));\r\n/* harmony default export */ var o = (o_O);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/s.ts\nvar s___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar s_c = 3;\r\nvar s_S = (function (_super) {\r\n    s___extends(S, _super);\r\n    function S() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, s_c, s_c],\r\n            [s_c, s_c, 0],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return S;\r\n}(models_shape));\r\n/* harmony default export */ var s = (s_S);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/t.ts\nvar t___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar t_c = 7;\r\nvar t_T = (function (_super) {\r\n    t___extends(T, _super);\r\n    function T() {\r\n        return _super.call(this, xyMatrix([\r\n            [t_c, t_c, t_c],\r\n            [0, t_c, 0],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return T;\r\n}(models_shape));\r\n/* harmony default export */ var t = (t_T);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/z.ts\nvar z___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar z_c = 4;\r\nvar z_Z = (function (_super) {\r\n    z___extends(Z, _super);\r\n    function Z() {\r\n        return _super.call(this, xyMatrix([\r\n            [z_c, z_c, 0],\r\n            [0, z_c, z_c],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return Z;\r\n}(models_shape));\r\n/* harmony default export */ var z = (z_Z);\r\n\n// CONCATENATED MODULE: ./src/services/random-shape.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar shapes = [i, j, l, o, s, t, z];\r\nfunction getRandomShape() {\r\n    var Shape = shapes[Math.floor(Math.random() * shapes.length)];\r\n    return new Shape();\r\n}\r\n\n// CONCATENATED MODULE: ./src/models/player.ts\n\r\n\r\n\r\nvar player_Player = (function () {\r\n    function Player(startingPosition) {\r\n        this._startingPos = startingPosition;\r\n        this.reset();\r\n    }\r\n    Object.defineProperty(Player.prototype, \"shape\", {\r\n        get: function () {\r\n            return this._shape;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Player.prototype.reset = function () {\r\n        this.position = clonePoint(this._startingPos);\r\n        this._shape = getRandomShape();\r\n    };\r\n    Player.prototype.getContainedPosition = function (board) {\r\n        var position = clonePoint(this.position);\r\n        var xLow = findIndex(this._shape.blocks, function (col) {\r\n            return findAny(col, function (value) { return !!value; });\r\n        }) + position.x;\r\n        if (xLow < 0) {\r\n            position.x += 0 - xLow;\r\n            return position;\r\n        }\r\n        var xHigh = this._shape.blocks.length -\r\n            findIndex(this._shape.blocks.reverse(), function (col) {\r\n                return findAny(col, function (value) { return !!value; });\r\n            }) + position.x;\r\n        if (xHigh > board.blocks.length) {\r\n            position.x -= xHigh - board.blocks.length;\r\n            return position;\r\n        }\r\n        return position;\r\n    };\r\n    return Player;\r\n}());\r\n/* harmony default export */ var player = (player_Player);\r\n\n// CONCATENATED MODULE: ./src/services/clear-panel.ts\nfunction clearPanel(panel) {\r\n    panel.ctx.clearRect(0, 0, panel.size.width, panel.size.height);\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/draw-grid.ts\nfunction drawGrid(panel, gridSize) {\r\n    var tileSize = {\r\n        width: panel.size.width / gridSize.width,\r\n        height: panel.size.height / gridSize.height\r\n    };\r\n    var ctx = panel.ctx;\r\n    ctx.strokeStyle = '#efefef';\r\n    ctx.lineWidth = panel.pixelRatio;\r\n    for (var x = 0; x < panel.size.width; x += tileSize.width) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, 0);\r\n        ctx.lineTo(x, panel.size.height);\r\n        ctx.stroke();\r\n    }\r\n    for (var y = 0; y < panel.size.height; y += tileSize.height) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, y);\r\n        ctx.lineTo(panel.size.width, y);\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n// CONCATENATED MODULE: ./src/settings.ts\nvar settings = {\r\n    drawEmptyTiles: false,\r\n    points: {\r\n        linesCleared: {\r\n            1: 40,\r\n            2: 100,\r\n            3: 300,\r\n            4: 1200\r\n        },\r\n        softDrop: 1,\r\n        hardDrop: 2,\r\n        softDropMax: 20,\r\n        hardDropMax: 40\r\n    }\r\n};\r\n/* harmony default export */ var src_settings = (settings);\r\n\n// CONCATENATED MODULE: ./src/services/draw-matrix.ts\n\r\nfunction drawMatrix(panel, matrix) {\r\n    var ctx = panel.ctx;\r\n    var tileSize = {\r\n        width: panel.size.width / matrix.length,\r\n        height: panel.size.height / matrix[0].length\r\n    };\r\n    matrix.forEach(function (col, x) { return col.forEach(function (item, y) {\r\n        if (typeof item === 'undefined' ||\r\n            !src_settings.drawEmptyTiles && !item)\r\n            return;\r\n        ctx.fillStyle = item ? getColorCode(item) : '#8ED6FF';\r\n        ctx.fillRect(x * tileSize.width, y * tileSize.height, tileSize.width, tileSize.height);\r\n    }); });\r\n}\r\nfunction getColorCode(color) {\r\n    switch (color) {\r\n        case 1:\r\n            return '#ffeb3b';\r\n        case 2:\r\n            return '#03a9f4';\r\n        case 3:\r\n            return '#f44336';\r\n        case 4:\r\n            return '#4caf50';\r\n        case 5:\r\n            return '#ff9800';\r\n        case 6:\r\n            return '#fbafbc';\r\n        case 7:\r\n            return '#9c27b0';\r\n        default:\r\n            return '#000';\r\n    }\r\n}\r\n\n// EXTERNAL MODULE: ./src/vendor/modernizr.min.js\nvar modernizr_min = __webpack_require__(1);\nvar modernizr_min_default = /*#__PURE__*/__webpack_require__.n(modernizr_min);\n\n// CONCATENATED MODULE: ./src/index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar el = document.getElementById('game');\r\nvar pixelRatio = devicePixelRatio || 1;\r\nvar ctxSize = {\r\n    width: parseInt(el.getAttribute('width'), 10) * pixelRatio,\r\n    height: parseInt(el.getAttribute('height'), 10) * pixelRatio\r\n};\r\nif (ctxSize.width !== el.offsetWidth) {\r\n    el.setAttribute('width', \"\" + ctxSize.width);\r\n}\r\nif (ctxSize.height !== el.offsetHeight) {\r\n    el.setAttribute('height', \"\" + ctxSize.height);\r\n}\r\nvar boardSize = {\r\n    width: 16,\r\n    height: 24\r\n};\r\nvar src_panel = getPanel('game', ctxSize, pixelRatio);\r\nvar src_board = new models_board(boardSize);\r\nvar src_player = new player({ x: 7, y: 0 });\r\nvar softDropPoints = 0;\r\nfunction update() {\r\n    var newPos = {\r\n        x: src_player.position.x,\r\n        y: src_player.position.y + 1\r\n    };\r\n    if (!src_board.collides(src_player.shape.blocks, newPos)) {\r\n        src_player.position = newPos;\r\n    }\r\n    else {\r\n        src_board.place(src_player.shape, src_player.position);\r\n        var linesCleared = src_board.clearFullLines();\r\n        if (linesCleared) {\r\n            var scoring = src_settings.points.linesCleared;\r\n            addScore(scoring[linesCleared]);\r\n        }\r\n        src_player.reset();\r\n        softDropPoints = 0;\r\n        if (src_board.collides(src_player.shape.blocks, src_player.position)) {\r\n            gameOver();\r\n        }\r\n    }\r\n    draw();\r\n}\r\nfunction draw() {\r\n    var viewMatrix = mergeMatrixes(src_board.blocks, src_player.shape.blocks, src_player.position);\r\n    clearPanel(src_panel);\r\n    drawGrid(src_panel, boardSize);\r\n    drawMatrix(src_panel, viewMatrix);\r\n}\r\nvar interval;\r\nvar src_s = 0.5;\r\nfunction initInterval() {\r\n    window.clearInterval(interval);\r\n    update();\r\n    interval = window.setInterval(update, src_s * 1000);\r\n}\r\ninitInterval();\r\nfunction gameOver() {\r\n    src_board.clear();\r\n    src_player.reset();\r\n    resetScore();\r\n}\r\ndocument.addEventListener('keydown', function (e) {\r\n    var newPosition = {\r\n        x: src_player.position.x,\r\n        y: src_player.position.y\r\n    };\r\n    var triggered = true;\r\n    switch (e.code) {\r\n        case 'ArrowUp':\r\n            if (e.repeat)\r\n                return;\r\n            src_player.shape.rotate();\r\n            if (!src_board.contains(src_player.shape.blocks, newPosition)) {\r\n                newPosition = src_player.getContainedPosition(src_board);\r\n            }\r\n            break;\r\n        case 'ArrowRight':\r\n            newPosition.x++;\r\n            break;\r\n        case 'ArrowDown':\r\n            newPosition.y++;\r\n            var sdPoints = src_settings.points.softDrop;\r\n            softDropPoints += sdPoints;\r\n            if (softDropPoints < src_settings.points.softDropMax) {\r\n                addScore(sdPoints);\r\n            }\r\n            break;\r\n        case 'ArrowLeft':\r\n            newPosition.x--;\r\n            break;\r\n        case 'Space':\r\n            var nextPos = newPosition;\r\n            var hdPoints = 0;\r\n            do {\r\n                nextPos = { x: nextPos.x, y: nextPos.y + 1 };\r\n                hdPoints += src_settings.points.hardDrop;\r\n            } while (!src_board.collides(src_player.shape.blocks, nextPos));\r\n            newPosition = { x: nextPos.x, y: nextPos.y - 1 };\r\n            addScore(Math.min(hdPoints - src_settings.points.hardDrop, src_settings.points.hardDropMax));\r\n            break;\r\n        default:\r\n            triggered = false;\r\n            break;\r\n    }\r\n    var posChanged = !pointEquals(src_player.position, newPosition);\r\n    if (posChanged) {\r\n        if (!src_board.collides(src_player.shape.blocks, newPosition)) {\r\n            src_player.position = newPosition;\r\n        }\r\n        else\r\n            initInterval();\r\n    }\r\n    if (triggered) {\r\n        e.preventDefault();\r\n        draw();\r\n    }\r\n});\r\nloadPlayerScore();\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n/*! modernizr 3.5.0 (Custom Build) | MIT *\r\n * https://modernizr.com/download/?-canvas-localstorage-serviceworker-sessionstorage-touchevents-webgl !*/\r\n!function(e,t,n){function o(e,t){return typeof e===t}function r(){var e,t,n,r,s,a,i;for(var d in l)if(l.hasOwnProperty(d)){if(e=[],t=l[d],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(r=o(t.fn,\"function\")?t.fn():t.fn,s=0;s<e.length;s++)a=e[s],i=a.split(\".\"),1===i.length?Modernizr[i[0]]=r:(!Modernizr[i[0]]||Modernizr[i[0]]instanceof Boolean||(Modernizr[i[0]]=new Boolean(Modernizr[i[0]])),Modernizr[i[0]][i[1]]=r),c.push((r?\"\":\"no-\")+i.join(\"-\"))}}function s(){return\"function\"!=typeof t.createElement?t.createElement(arguments[0]):u?t.createElementNS.call(t,\"http://www.w3.org/2000/svg\",arguments[0]):t.createElement.apply(t,arguments)}function a(){var e=t.body;return e||(e=s(u?\"svg\":\"body\"),e.fake=!0),e}function i(e,n,o,r){var i,l,d,c,u=\"modernizr\",p=s(\"div\"),v=a();if(parseInt(o,10))for(;o--;)d=s(\"div\"),d.id=r?r[o]:u+(o+1),p.appendChild(d);return i=s(\"style\"),i.type=\"text/css\",i.id=\"s\"+u,(v.fake?v:p).appendChild(i),v.appendChild(p),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),p.id=u,v.fake&&(v.style.background=\"\",v.style.overflow=\"hidden\",c=f.style.overflow,f.style.overflow=\"hidden\",f.appendChild(v)),l=n(p,e),v.fake?(v.parentNode.removeChild(v),f.style.overflow=c,f.offsetHeight):p.parentNode.removeChild(p),!!l}var l=[],d={_version:\"3.5.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){l.push({name:e,fn:t,options:n})},addAsyncTest:function(e){l.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=d,Modernizr=new Modernizr,Modernizr.addTest(\"serviceworker\",\"serviceWorker\"in navigator),Modernizr.addTest(\"localstorage\",function(){var e=\"modernizr\";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}),Modernizr.addTest(\"sessionstorage\",function(){var e=\"modernizr\";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}});var c=[],f=t.documentElement,u=\"svg\"===f.nodeName.toLowerCase();Modernizr.addTest(\"canvas\",function(){var e=s(\"canvas\");return!(!e.getContext||!e.getContext(\"2d\"))}),Modernizr.addTest(\"webgl\",function(){var t=s(\"canvas\"),n=\"probablySupportsContext\"in t?\"probablySupportsContext\":\"supportsContext\";return n in t?t[n](\"webgl\")||t[n](\"experimental-webgl\"):\"WebGLRenderingContext\"in e});var p=d._config.usePrefixes?\" -webkit- -moz- -o- -ms- \".split(\" \"):[\"\",\"\"];d._prefixes=p;var v=d.testStyles=i;Modernizr.addTest(\"touchevents\",function(){var n;if(\"ontouchstart\"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var o=[\"@media (\",p.join(\"touch-enabled),(\"),\"heartz\",\")\",\"{#modernizr{top:9px;position:absolute}}\"].join(\"\");v(o,function(e){n=9===e.offsetTop})}return n}),r(),delete d.addTest,delete d.addAsyncTest;for(var m=0;m<Modernizr._q.length;m++)Modernizr._q[m]();e.Modernizr=Modernizr}(window,document);\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d1c1fc96a6197189833b","let currentScore = 0;\r\n\r\nexport function addScore(points: number): void {\r\n    currentScore += points;\r\n    triggerScoreChange();\r\n}\r\n\r\nexport function resetScore(): void {\r\n    currentScore = 0;\r\n    triggerScoreChange();\r\n}\r\n\r\nconst subscribers: Array<(score: number) => void> = [];\r\nexport function onScoreChange(handler: (score: number) => void, triggerOnInit = false): void {\r\n    subscribers.push(handler);\r\n    if (triggerOnInit) handler(currentScore);\r\n}\r\n\r\nfunction triggerScoreChange(): void {\r\n    subscribers.forEach(handler => handler(currentScore));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/player-score.ts","export default interface IPoint {\r\n    x: number;\r\n    y: number;\r\n}\r\n\r\nexport function clonePoint(point: IPoint): IPoint {\r\n    return { x: point.x, y: point.y };\r\n}\r\n\r\nexport function pointEquals(a: IPoint, b: IPoint): boolean {\r\n    return a.x === b.x && a.y === b.y;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/interfaces/point.ts","import Matrix from '../interfaces/matrix';\r\nimport IPoint from '../interfaces/point';\r\nimport { ISize } from '../interfaces/size';\r\n\r\nexport function createMatrix(size: ISize): Matrix {\r\n    const result: Matrix = [];\r\n    for (let col = 0; col < size.width; col++) {\r\n        result[col] = new Array(size.height);\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function copyMatrix(matrix: Matrix): Matrix {\r\n    return matrix.reduce<Matrix>((result, col, x) => {\r\n        result[x] = col.slice();\r\n        return result;\r\n    }, []);\r\n}\r\n\r\n/**\r\n * Merges m1 and m2 into a new matrix with the size of m1\r\n * @param position Position of m2 on m1\r\n */\r\nexport function mergeMatrixes(m1: Matrix, m2: Matrix, position: IPoint, target?: Matrix): Matrix {\r\n    const result = target || copyMatrix(m1);\r\n\r\n    for (let i = 0; i < m2.length; i++) {\r\n        for (let j = 0; j < m2[0].length; j++) {\r\n            const value = m2[i][j];\r\n            if (typeof value === 'undefined') continue;\r\n\r\n            const x = i + position.x;\r\n            const y = j + position.y;\r\n\r\n            if (x >= 0 && x < m1.length &&\r\n                y >= 0 && y < m1[0].length &&\r\n                (value || !result[x][y])) {\r\n                result[x][y] = value;\r\n            }\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function addMatrix(target: Matrix, source: Matrix, position: IPoint): void {\r\n    mergeMatrixes(target, source, position, target);\r\n}\r\n\r\n/**\r\n * Transforms matrix to be used in the coordinate system\r\n */\r\nexport function xyMatrix(matrix: Matrix): Matrix {\r\n    return rotateMatrix(matrix)\r\n        .reduce<Matrix>((result, col, x) => {\r\n            // Flip columns\r\n            result[x] = col.reverse();\r\n            return result;\r\n        }, []);\r\n}\r\n\r\n/**\r\n * Rotate a square 2D matrix\r\n */\r\nexport function rotateMatrix(matrix: Matrix, reverse = false): Matrix {\r\n    const l = matrix.length;\r\n    const result = createMatrix({ width: l, height: l });\r\n\r\n    // Apply rotation\r\n    for (let x = 0; x < l; x++) {\r\n        for (let y = 0; y < l; y++) {\r\n            result[x][y] = reverse\r\n                ? matrix[l - y - 1][x]\r\n                : matrix[y][l - x - 1];\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Checks if child is not outside parent matrix\r\n */\r\nexport function matrixContains(parent: Matrix, child: Matrix, position: IPoint): boolean {\r\n    for (let i = 0; i < child.length; i++) {\r\n        const col = child[i];\r\n        for (let j = 0; j < col.length; j++) {\r\n            if (!col[j]) continue;\r\n\r\n            const x = i + position.x;\r\n            const y = j + position.y;\r\n\r\n            if (x < 0 || x >= parent.length ||\r\n                y < 0 || y >= parent[0].length) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nexport function matrixesColliding(m1: Matrix, m2: Matrix, position: IPoint): boolean {\r\n    for (let x = 0; x < m2.length; x++) {\r\n        for (let y = 0; y < m2[0].length; y++) {\r\n            if (!m2[x][y]) continue;\r\n            if (m1[x + position.x][y + position.y]) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/matrix-calculations.ts","export function findIndex<T>(array: T[], predicate: (item: T, index: number) => boolean): number | undefined {\r\n    for (let i = 0; i < array.length; i++) {\r\n        const value = array[i];\r\n        if (predicate(value, i)) {\r\n            return i;\r\n        }\r\n    }\r\n}\r\n\r\nexport function findAny<T>(array: T[], predicate: (item: T, index: number) => boolean): boolean {\r\n    return typeof findIndex(array, predicate) !== 'undefined';\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/arrays.ts","import I from '../models/shapes/i';\r\nimport J from '../models/shapes/j';\r\nimport L from '../models/shapes/l';\r\nimport O from '../models/shapes/o';\r\nimport S from '../models/shapes/s';\r\nimport T from '../models/shapes/t';\r\nimport Z from '../models/shapes/z';\r\n\r\nconst shapes = [I, J, L, O, S, T, Z];\r\n\r\nexport default function getRandomShape() {\r\n    const Shape = shapes[Math.floor(Math.random() * shapes.length)];\r\n    return new Shape();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/random-shape.ts","import IPanel from '../models/panel';\r\n\r\nexport default function clearPanel(panel: IPanel): void {\r\n    panel.ctx.clearRect(0, 0, panel.size.width, panel.size.height);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/clear-panel.ts","import { ISize } from '../interfaces/size';\r\nimport IPanel from '../models/panel';\r\n\r\nexport default function drawGrid(panel: IPanel, gridSize: ISize): void {\r\n    const tileSize: ISize = {\r\n        width: panel.size.width / gridSize.width,\r\n        height: panel.size.height / gridSize.height\r\n    };\r\n\r\n    const { ctx } = panel;\r\n    ctx.strokeStyle = '#efefef';\r\n    ctx.lineWidth = panel.pixelRatio;\r\n\r\n    for (let x = 0; x < panel.size.width; x += tileSize.width) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, 0);\r\n        ctx.lineTo(x, panel.size.height);\r\n        ctx.stroke();\r\n    }\r\n\r\n    for (let y = 0; y < panel.size.height; y += tileSize.height) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, y);\r\n        ctx.lineTo(panel.size.width, y);\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/draw-grid.ts","import Matrix from '../interfaces/matrix';\r\nimport { ISize } from '../interfaces/size';\r\nimport { Color } from '../models/color';\r\nimport IPanel from '../models/panel';\r\nimport settings from '../settings';\r\n\r\nexport default function drawMatrix(panel: IPanel, matrix: Matrix): void {\r\n    const ctx = panel.ctx;\r\n\r\n    const tileSize: ISize = {\r\n        width: panel.size.width / matrix.length,\r\n        height: panel.size.height / matrix[0].length\r\n    };\r\n\r\n    matrix.forEach((col, x) => col.forEach((item, y) => {\r\n        if (typeof item === 'undefined' ||\r\n            !settings.drawEmptyTiles && !item) return;\r\n\r\n        ctx.fillStyle = item ? getColorCode(item) : '#8ED6FF';\r\n        ctx.fillRect(x * tileSize.width, y * tileSize.height,\r\n            tileSize.width, tileSize.height);\r\n    }));\r\n}\r\n\r\nfunction getColorCode(color: Color): string {\r\n    switch (color) {\r\n        case Color.Yellow:\r\n            return '#ffeb3b';\r\n        case Color.Blue:\r\n            return '#03a9f4';\r\n        case Color.Red:\r\n            return '#f44336';\r\n        case Color.Green:\r\n            return '#4caf50';\r\n        case Color.Orange:\r\n            return '#ff9800';\r\n        case Color.Pink:\r\n            return '#fbafbc';\r\n        case Color.Purple:\r\n            return '#9c27b0';\r\n        default:\r\n            return '#000';\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/draw-matrix.ts","import loadPlayerScore from './components/player-score';\r\nimport { pointEquals } from './interfaces/point';\r\nimport { ISize } from './interfaces/size';\r\nimport Board from './models/board';\r\nimport { getPanel } from './models/panel';\r\nimport Player from './models/player';\r\nimport clearPanel from './services/clear-panel';\r\nimport drawGrid from './services/draw-grid';\r\nimport drawMatrix from './services/draw-matrix';\r\nimport { mergeMatrixes } from './services/matrix-calculations';\r\nimport { addScore, resetScore } from './services/player-score';\r\nimport settings from './settings';\r\nimport './vendor/modernizr.min.js';\r\n\r\n// Read context size\r\nconst el = document.getElementById('game') as HTMLCanvasElement;\r\nconst pixelRatio = devicePixelRatio || 1;\r\n\r\nconst ctxSize: ISize = {\r\n    width: parseInt(el.getAttribute('width') as string, 10) * pixelRatio,\r\n    height: parseInt(el.getAttribute('height') as string, 10) * pixelRatio\r\n};\r\n\r\n// Fix scaling for small viewports\r\nif (ctxSize.width !== el.offsetWidth) {\r\n    el.setAttribute('width', `${ctxSize.width}`);\r\n}\r\n\r\nif (ctxSize.height !== el.offsetHeight) {\r\n    el.setAttribute('height', `${ctxSize.height}`);\r\n}\r\n\r\n// Declare tile count on board\r\nconst boardSize: ISize = {\r\n    width: 16,\r\n    height: 24\r\n};\r\n\r\n// Create panel\r\nconst panel = getPanel('game', ctxSize, pixelRatio);\r\nconst board = new Board(boardSize);\r\n\r\n// Place a random shape\r\nconst player = new Player({ x: 7, y: 0 });\r\nlet softDropPoints = 0;\r\n\r\n// Update loop\r\nfunction update(): void {\r\n    const newPos = {\r\n        x: player.position.x,\r\n        y: player.position.y + 1\r\n    };\r\n\r\n    if (!board.collides(player.shape.blocks, newPos)) {\r\n        player.position = newPos;\r\n    } else {\r\n        // Colliding\r\n        board.place(player.shape, player.position);\r\n        const linesCleared = board.clearFullLines();\r\n\r\n        // Add points for cleared lines\r\n        if (linesCleared) {\r\n            const scoring = settings.points.linesCleared as { [lines: number]: number };\r\n            addScore(scoring[linesCleared]);\r\n        }\r\n\r\n        // Reset player\r\n        player.reset();\r\n        softDropPoints = 0;\r\n\r\n        // Detect immediate collision\r\n        if (board.collides(player.shape.blocks, player.position)) {\r\n            gameOver();\r\n        }\r\n    }\r\n\r\n    draw();\r\n}\r\n\r\nfunction draw(): void {\r\n    const viewMatrix = mergeMatrixes(board.blocks, player.shape.blocks, player.position);\r\n\r\n    clearPanel(panel);\r\n    drawGrid(panel, boardSize);\r\n    drawMatrix(panel, viewMatrix);\r\n}\r\n\r\n// Call update every s seconds\r\nlet interval: number;\r\nconst s = 0.5;\r\nfunction initInterval(): void {\r\n    window.clearInterval(interval);\r\n    update();\r\n    interval = window.setInterval(update, s * 1000);\r\n}\r\ninitInterval();\r\n\r\n// Game over handling\r\nfunction gameOver(): void {\r\n    board.clear();\r\n    player.reset();\r\n    resetScore();\r\n}\r\n\r\n// Key handling\r\ndocument.addEventListener('keydown', e => {\r\n\r\n    let newPosition = {\r\n        x: player.position.x,\r\n        y: player.position.y\r\n    };\r\n\r\n    let triggered = true;\r\n    switch (e.code) {\r\n        case 'ArrowUp':\r\n            // Rotate clockwise\r\n            if (e.repeat) return;\r\n            player.shape.rotate();\r\n\r\n            // Push shape back on to the board\r\n            if (!board.contains(player.shape.blocks, newPosition)) {\r\n                newPosition = player.getContainedPosition(board);\r\n            }\r\n\r\n            break;\r\n        case 'ArrowRight':\r\n            // Move right\r\n            newPosition.x++;\r\n            break;\r\n        case 'ArrowDown':\r\n            // Soft drop\r\n            newPosition.y++;\r\n\r\n            // Add points to score\r\n            const sdPoints = settings.points.softDrop;\r\n            softDropPoints += sdPoints;\r\n            if (softDropPoints < settings.points.softDropMax) {\r\n                addScore(sdPoints);\r\n            }\r\n\r\n            break;\r\n        case 'ArrowLeft':\r\n            // Move left\r\n            newPosition.x--;\r\n            break;\r\n        case 'Space':\r\n            // Hard drop\r\n            let nextPos = newPosition;\r\n            let hdPoints = 0;\r\n\r\n            do {\r\n                nextPos = { x: nextPos.x, y: nextPos.y + 1 };\r\n                hdPoints += settings.points.hardDrop;\r\n            } while (!board.collides(player.shape.blocks, nextPos));\r\n\r\n            newPosition = { x: nextPos.x, y: nextPos.y - 1 };\r\n            addScore(Math.min(\r\n                hdPoints - settings.points.hardDrop,\r\n                settings.points.hardDropMax));\r\n\r\n            break;\r\n        default:\r\n            triggered = false;\r\n            break;\r\n    }\r\n\r\n    const posChanged = !pointEquals(player.position, newPosition);\r\n\r\n    if (posChanged) {\r\n        if (!board.collides(player.shape.blocks, newPosition)) {\r\n            player.position = newPosition;\r\n        } else initInterval();\r\n    }\r\n\r\n    if (triggered) {\r\n        e.preventDefault();\r\n        draw();\r\n    }\r\n});\r\n\r\n// Load components\r\nloadPlayerScore();\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/index.ts","import { onScoreChange } from '../services/player-score';\r\n\r\nlet scoreEl: HTMLSpanElement;\r\n\r\nexport default function loadPlayerScore(): void {\r\n    scoreEl = document.getElementById('player-score') as HTMLSpanElement;\r\n    onScoreChange(score => {\r\n        scoreEl.textContent = score.toLocaleString();\r\n    }, true);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/components/player-score.ts","import Matrix from '../interfaces/matrix';\r\nimport IPoint from '../interfaces/point';\r\nimport { ISize } from '../interfaces/size';\r\nimport { addMatrix, matrixContains, matrixesColliding } from '../services/matrix-calculations';\r\nimport Shape from './shape';\r\n\r\nexport default class Board {\r\n    private _blocks: Matrix;\r\n    public get blocks() { return this._blocks; }\r\n\r\n    public readonly size: ISize;\r\n\r\n    constructor(size: ISize) {\r\n        this.size = size;\r\n        this.clear();\r\n    }\r\n\r\n    public place(shape: Shape, position: IPoint): void {\r\n        addMatrix(this.blocks, shape.blocks, position);\r\n    }\r\n\r\n    public clearFullLines(): number {\r\n        const fullRows = this.getFullLines();\r\n        fullRows.forEach(row => this.deleteRow(row));\r\n        return fullRows.length;\r\n    }\r\n\r\n    private getFullLines(): number[] {\r\n        const rowCount = this._blocks[0].length;\r\n        const incompleteRows = new Array<boolean>(rowCount - 1);\r\n\r\n        rows:\r\n        for (let y = 0; y < rowCount; y++) {\r\n            // tslint:disable-next-line:prefer-for-of\r\n            for (let x = 0; x < this._blocks.length; x++) {\r\n                if (!this._blocks[x][y]) {\r\n                    incompleteRows[y] = true;\r\n                    continue rows;\r\n                }\r\n            }\r\n        }\r\n\r\n        const result: number[] = [];\r\n        for (let row = 0; row < rowCount; row++) {\r\n            if (!incompleteRows[row]) result.push(row);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private deleteRow(row: number): void {\r\n        this._blocks.forEach(col => {\r\n            col.splice(row, 1);\r\n            col.unshift(undefined);\r\n        });\r\n    }\r\n\r\n    public clear(): void {\r\n        this._blocks = [];\r\n        for (let x = 0; x < this.size.width; x++) {\r\n            this._blocks[x] = new Array(this.size.height);\r\n        }\r\n    }\r\n\r\n    public contains(matrix: Matrix, position: IPoint): boolean {\r\n        return matrixContains(this._blocks, matrix, position);\r\n    }\r\n\r\n    public collides(matrix: Matrix, position: IPoint): boolean {\r\n        return !this.contains(matrix, position)\r\n            || matrixesColliding(this.blocks, matrix, position);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/board.ts","import Matrix from '../interfaces/matrix';\r\nimport { rotateMatrix } from '../services/matrix-calculations';\r\n\r\nexport default class Shape {\r\n    private _blocks: Matrix;\r\n    public get blocks() {\r\n        return this._blocks;\r\n    }\r\n\r\n    constructor(blocks: Matrix) {\r\n        this._blocks = blocks;\r\n    }\r\n\r\n    public rotate(reverse = false): void {\r\n        this._blocks = rotateMatrix(this._blocks, reverse);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shape.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Blue;\r\n\r\nexport default class I extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/i.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Pink;\r\n\r\nexport default class J extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0],\r\n            [0, c, 0],\r\n            [c, c, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/j.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Orange;\r\n\r\nexport default class L extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0],\r\n            [0, c, 0],\r\n            [0, c, c]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/l.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Yellow;\r\n\r\nexport default class O extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c],\r\n            [c, c]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/o.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Red;\r\n\r\nexport default class S extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, c],\r\n            [c, c, 0],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/s.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Purple;\r\n\r\nexport default class T extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c, c],\r\n            [0, c, 0],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/t.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Green;\r\n\r\nexport default class Z extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c, 0],\r\n            [0, c, c],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/z.ts","import IPoint, { clonePoint } from '../interfaces/point';\r\nimport { findAny, findIndex } from '../services/arrays';\r\nimport getRandomShape from '../services/random-shape';\r\nimport Board from './board';\r\nimport Shape from './shape';\r\n\r\nexport default class Player {\r\n    private _shape: Shape;\r\n    public get shape() {\r\n        return this._shape;\r\n    }\r\n\r\n    public position: IPoint;\r\n    private _startingPos: IPoint;\r\n\r\n    constructor(startingPosition: IPoint) {\r\n        this._startingPos = startingPosition;\r\n        this.reset();\r\n    }\r\n\r\n    public reset(): void {\r\n        this.position = clonePoint(this._startingPos);\r\n        this._shape = getRandomShape();\r\n    }\r\n\r\n    /**\r\n     * Calculates a position for\r\n     * the player to be fully on the board\r\n     */\r\n    public getContainedPosition(board: Board): IPoint {\r\n        const position = clonePoint(this.position);\r\n\r\n        // Find lowest x value\r\n        const xLow = (findIndex(this._shape.blocks, col => {\r\n            // Column contains a value\r\n            return findAny(col, value => !!value);\r\n        }) as number) + position.x;\r\n\r\n        // Push shape to the right\r\n        if (xLow < 0) {\r\n            position.x += 0 - xLow;\r\n            return position;\r\n        }\r\n\r\n        // Find highest x value\r\n        const xHigh = this._shape.blocks.length -\r\n            (findIndex(this._shape.blocks.reverse(), col => {\r\n                // Column contains a value\r\n                return findAny(col, value => !!value);\r\n            }) as number) + position.x;\r\n\r\n        // Push shape to the left\r\n        if (xHigh > board.blocks.length) {\r\n            position.x -= xHigh - board.blocks.length;\r\n            return position;\r\n        }\r\n\r\n        return position;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/player.ts","const settings = {\r\n    drawEmptyTiles: false,\r\n    points: {\r\n        // Amount of lines cleared at once\r\n        linesCleared: {\r\n            1: 40,\r\n            2: 100,\r\n            3: 300,\r\n            4: 1200\r\n        },\r\n\r\n        // Points per cell dropped\r\n        softDrop: 1,\r\n        hardDrop: 2,\r\n\r\n        // Max drop points per turn\r\n        softDropMax: 20,\r\n        hardDropMax: 40\r\n    }\r\n};\r\n\r\nexport default settings;\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/settings.ts","import { ISize } from '../interfaces/size';\r\n\r\nexport default interface IPanel {\r\n    ctx: CanvasRenderingContext2D;\r\n    size: ISize;\r\n    pixelRatio: number;\r\n}\r\n\r\nexport function getPanel(canvasID: string, size: ISize, pixelRatio: number): IPanel {\r\n    const canvas = document.getElementById(canvasID) as HTMLCanvasElement;\r\n    if (!canvas) throw new Error('Canvas not found!');\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) throw new Error('Context not found!');\r\n\r\n    return { ctx, size, pixelRatio };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/panel.ts","/*! modernizr 3.5.0 (Custom Build) | MIT *\r\n * https://modernizr.com/download/?-canvas-localstorage-serviceworker-sessionstorage-touchevents-webgl !*/\r\n!function(e,t,n){function o(e,t){return typeof e===t}function r(){var e,t,n,r,s,a,i;for(var d in l)if(l.hasOwnProperty(d)){if(e=[],t=l[d],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(r=o(t.fn,\"function\")?t.fn():t.fn,s=0;s<e.length;s++)a=e[s],i=a.split(\".\"),1===i.length?Modernizr[i[0]]=r:(!Modernizr[i[0]]||Modernizr[i[0]]instanceof Boolean||(Modernizr[i[0]]=new Boolean(Modernizr[i[0]])),Modernizr[i[0]][i[1]]=r),c.push((r?\"\":\"no-\")+i.join(\"-\"))}}function s(){return\"function\"!=typeof t.createElement?t.createElement(arguments[0]):u?t.createElementNS.call(t,\"http://www.w3.org/2000/svg\",arguments[0]):t.createElement.apply(t,arguments)}function a(){var e=t.body;return e||(e=s(u?\"svg\":\"body\"),e.fake=!0),e}function i(e,n,o,r){var i,l,d,c,u=\"modernizr\",p=s(\"div\"),v=a();if(parseInt(o,10))for(;o--;)d=s(\"div\"),d.id=r?r[o]:u+(o+1),p.appendChild(d);return i=s(\"style\"),i.type=\"text/css\",i.id=\"s\"+u,(v.fake?v:p).appendChild(i),v.appendChild(p),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),p.id=u,v.fake&&(v.style.background=\"\",v.style.overflow=\"hidden\",c=f.style.overflow,f.style.overflow=\"hidden\",f.appendChild(v)),l=n(p,e),v.fake?(v.parentNode.removeChild(v),f.style.overflow=c,f.offsetHeight):p.parentNode.removeChild(p),!!l}var l=[],d={_version:\"3.5.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){l.push({name:e,fn:t,options:n})},addAsyncTest:function(e){l.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=d,Modernizr=new Modernizr,Modernizr.addTest(\"serviceworker\",\"serviceWorker\"in navigator),Modernizr.addTest(\"localstorage\",function(){var e=\"modernizr\";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}),Modernizr.addTest(\"sessionstorage\",function(){var e=\"modernizr\";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}});var c=[],f=t.documentElement,u=\"svg\"===f.nodeName.toLowerCase();Modernizr.addTest(\"canvas\",function(){var e=s(\"canvas\");return!(!e.getContext||!e.getContext(\"2d\"))}),Modernizr.addTest(\"webgl\",function(){var t=s(\"canvas\"),n=\"probablySupportsContext\"in t?\"probablySupportsContext\":\"supportsContext\";return n in t?t[n](\"webgl\")||t[n](\"experimental-webgl\"):\"WebGLRenderingContext\"in e});var p=d._config.usePrefixes?\" -webkit- -moz- -o- -ms- \".split(\" \"):[\"\",\"\"];d._prefixes=p;var v=d.testStyles=i;Modernizr.addTest(\"touchevents\",function(){var n;if(\"ontouchstart\"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var o=[\"@media (\",p.join(\"touch-enabled),(\"),\"heartz\",\")\",\"{#modernizr{top:9px;position:absolute}}\"].join(\"\");v(o,function(e){n=9===e.offsetTop})}return n}),r(),delete d.addTest,delete d.addAsyncTest;for(var m=0;m<Modernizr._q.length;m++)Modernizr._q[m]();e.Modernizr=Modernizr}(window,document);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/vendor/modernizr.min.js\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}