{"version":3,"sources":["webpack:///index.js","webpack:///webpack/bootstrap a8ef5fa0f3255c995aa2","webpack:///./src/services/player-score.ts","webpack:///./src/services/draw-grid.ts","webpack:///./src/models/color.ts","webpack:///./src/services/draw-matrix.ts","webpack:///./src/interfaces/point.ts","webpack:///./src/services/arrays.ts","webpack:///./src/services/matrix-calculations.ts","webpack:///./src/services/ghost-matrix.ts","webpack:///./src/services/view-matrix.ts","webpack:///./src/services/key-handling.ts","webpack:///./src/services/random-shape.ts","webpack:///./src/services/game-over.ts","webpack:///./src/services/gameloop.ts","webpack:///./src/components/player-score.ts","webpack:///./src/settings.ts","webpack:///./src/components/panel.ts","webpack:///./src/models/board.ts","webpack:///./src/services/timer.ts","webpack:///./src/services/unique-array.ts","webpack:///./src/models/shape.ts","webpack:///./src/models/shapes/i.ts","webpack:///./src/models/shapes/j.ts","webpack:///./src/models/shapes/l.ts","webpack:///./src/models/shapes/o.ts","webpack:///./src/models/shapes/s.ts","webpack:///./src/models/shapes/t.ts","webpack:///./src/models/shapes/z.ts","webpack:///./src/models/player.ts","webpack:///./src/services/storage.ts","webpack:///./src/index.ts","webpack:///./src/vendor/modernizr.min.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","addScore","points","currentScore","triggerScoreChange","resetScore","onScoreChange","handler","triggerOnInit","subscribers","push","forEach","drawGrid","panel","gridSize","tileSize","width","size","height","ctx","strokeStyle","lineWidth","pixelRatio","x","beginPath","moveTo","lineTo","stroke","y","getColorCode","color","drawMatrix","matrix","length","col","item","src_settings","debug","drawEmptyTiles","fillStyle","emptyColor","fillRect","Math","ceil","clonePoint","point","pointEquals","a","b","findIndex","array","predicate","findAny","createMatrix","result","Array","copyMatrix","reduce","slice","getMatrixSize","matrixEquals","m1","m2","value","mergeMatrixes","parent","child","target","childMatrix","position","j","xyMatrix","rotateMatrix","reverse","matrixContains","matrixesColliding","getUnstuckPosition","isColliding","shape","maxOffset","pos","createGhost","board","pm","collides","map","ghostColor","getViewMatrix","playerMatrix","storage_player","blocks","ghost","storage_board","resetControls","keysDown","remove","handleKeyDown","keyCode","repeated","newPosition","beforeMatrix","triggered","hardDropped","rotate","unstuckPos","bind","sdPoints","softDrop","softDropPoints","softDropMax","nextPos","hdPoints","hardDrop","min","hardDropMax","posChanged","newMatrix","placePiece","rotationChanged","stopLockTimeout","storage_panel","draw","getRandomShape","Shape","shapes","floor","random","gameOver","clear","reset","place","linesCleared","clearFullLines","lockTimeout","stop","update","newPos","start","scoreEl","interval","currentSeconds","settings","gameSpeed","1","2","3","4","placementTimeout","emptyTileColor","panel_Panel","Panel","id","canvas","document","getElementById","this","devicePixelRatio","parseInt","getAttribute","offsetWidth","setAttribute","offsetHeight","getContext","Error","clearRect","components_panel","board_Board","Board","_blocks","_this","fullRows","getFullLines","row","deleteRow","rowCount","incompleteRows","rows","_i","_a","splice","unshift","undefined","contains","models_board","Timer","repeat","_running","_handler","_interval","_repeat","executeOnInit","_handle","setInterval","setTimeout","clearInterval","clearTimeout","timer","UniqueArray","_array","add","index","indexOf","unique_array","keyInterval","values","code","keyThresholdTimer","shape_Shape","models_shape","__extends","extendStatics","setPrototypeOf","__proto__","__","constructor","create","i_I","_super","I","shapes_i","j___extends","j_c","j_J","J","l___extends","l_c","l_L","L","o___extends","o_c","o_O","O","s___extends","s_c","s_S","S","t___extends","t_c","t_T","T","t","z___extends","z_c","z_Z","Z","z","player_Player","Player","startingPosition","_startingPos","_shape","player","boardSize","seconds","window","running","addEventListener","e","preventDefault","count","score","textContent","toLocaleString","createElement","arguments","u","createElementNS","apply","body","fake","r","v","appendChild","type","styleSheet","cssText","createTextNode","style","background","overflow","f","parentNode","removeChild","_version","_config","classPrefix","enableClasses","enableJSClass","usePrefixes","_q","on","addTest","fn","options","addAsyncTest","Modernizr","navigator","localStorage","setItem","removeItem","sessionStorage","documentElement","nodeName","toLowerCase","split","_prefixes","testStyles","DocumentTouch","join","offsetTop","aliases","Boolean"],"mappings":"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","file":"index.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// CONCATENATED MODULE: ./src/services/player-score.ts\nvar currentScore = 0;\r\nfunction addScore(points) {\r\n    currentScore += points;\r\n    triggerScoreChange();\r\n}\r\nfunction resetScore() {\r\n    currentScore = 0;\r\n    triggerScoreChange();\r\n}\r\nvar subscribers = [];\r\nfunction onScoreChange(handler, triggerOnInit) {\r\n    if (triggerOnInit === void 0) { triggerOnInit = false; }\r\n    subscribers.push(handler);\r\n    if (triggerOnInit)\r\n        handler(currentScore);\r\n}\r\nfunction triggerScoreChange() {\r\n    subscribers.forEach(function (handler) { return handler(currentScore); });\r\n}\r\n\n// CONCATENATED MODULE: ./src/components/player-score.ts\n\r\nvar scoreEl;\r\nfunction loadPlayerScore() {\r\n    scoreEl = document.getElementById('player-score');\r\n    onScoreChange(function (score) {\r\n        scoreEl.textContent = score.toLocaleString();\r\n    }, true);\r\n}\r\n\n// CONCATENATED MODULE: ./src/settings.ts\nvar settings = {\r\n    gameSpeed: 0.4,\r\n    points: {\r\n        linesCleared: {\r\n            1: 40,\r\n            2: 100,\r\n            3: 300,\r\n            4: 1200\r\n        },\r\n        softDrop: 1,\r\n        hardDrop: 2,\r\n        softDropMax: 20,\r\n        hardDropMax: 40\r\n    },\r\n    placementTimeout: 0.5,\r\n    debug: {\r\n        drawEmptyTiles: false,\r\n        emptyTileColor: '#f1f1f1'\r\n    }\r\n};\r\n/* harmony default export */ var src_settings = (settings);\r\n\n// CONCATENATED MODULE: ./src/services/draw-grid.ts\nfunction drawGrid(panel, gridSize) {\r\n    var tileSize = {\r\n        width: panel.size.width / gridSize.width,\r\n        height: panel.size.height / gridSize.height\r\n    };\r\n    var ctx = panel.ctx;\r\n    ctx.strokeStyle = '#efefef';\r\n    ctx.lineWidth = panel.pixelRatio;\r\n    for (var x = 0; x < panel.size.width; x += tileSize.width) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, 0);\r\n        ctx.lineTo(x, panel.size.height);\r\n        ctx.stroke();\r\n    }\r\n    for (var y = 0; y < panel.size.height; y += tileSize.height) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, y);\r\n        ctx.lineTo(panel.size.width, y);\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n// CONCATENATED MODULE: ./src/models/color.ts\nfunction getColorCode(color) {\r\n    switch (color) {\r\n        case 1:\r\n            return '#ffeb3b';\r\n        case 2:\r\n            return '#03a9f4';\r\n        case 3:\r\n            return '#f44336';\r\n        case 4:\r\n            return '#4caf50';\r\n        case 5:\r\n            return '#ff9800';\r\n        case 6:\r\n            return '#fbafbc';\r\n        case 7:\r\n            return '#9c27b0';\r\n        case 8:\r\n            return '#e0e0e0';\r\n        default:\r\n            return '#000';\r\n    }\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/draw-matrix.ts\n\r\n\r\nvar emptyColor = src_settings.debug.emptyTileColor;\r\nfunction drawMatrix(panel, matrix) {\r\n    var ctx = panel.ctx;\r\n    var tileSize = {\r\n        width: panel.size.width / matrix.length,\r\n        height: panel.size.height / matrix[0].length\r\n    };\r\n    matrix.forEach(function (col, x) { return col.forEach(function (item, y) {\r\n        if (typeof item === 'undefined' ||\r\n            !src_settings.debug.drawEmptyTiles && !item)\r\n            return;\r\n        ctx.fillStyle = item ? getColorCode(item) : emptyColor;\r\n        ctx.fillRect(x * tileSize.width | 0, y * tileSize.height | 0, Math.ceil(tileSize.width), Math.ceil(tileSize.height));\r\n    }); });\r\n}\r\n\n// CONCATENATED MODULE: ./src/interfaces/point.ts\nfunction clonePoint(point) {\r\n    return { x: point.x, y: point.y };\r\n}\r\nfunction pointEquals(a, b) {\r\n    return a.x === b.x && a.y === b.y;\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/arrays.ts\nfunction findIndex(array, predicate) {\r\n    for (var i = 0; i < array.length; i++) {\r\n        var value = array[i];\r\n        if (predicate(value, i)) {\r\n            return i;\r\n        }\r\n    }\r\n}\r\nfunction findAny(array, predicate) {\r\n    return typeof findIndex(array, predicate) !== 'undefined';\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/matrix-calculations.ts\n\r\n\r\nfunction createMatrix(size) {\r\n    var result = [];\r\n    for (var col = 0; col < size.width; col++) {\r\n        result[col] = new Array(size.height);\r\n    }\r\n    return result;\r\n}\r\nfunction copyMatrix(matrix) {\r\n    return matrix.reduce(function (result, col, x) {\r\n        result[x] = col.slice();\r\n        return result;\r\n    }, []);\r\n}\r\nfunction getMatrixSize(matrix) {\r\n    return {\r\n        width: matrix.length,\r\n        height: matrix[0].length\r\n    };\r\n}\r\nfunction matrixEquals(m1, m2) {\r\n    if (m1.length !== m2.length\r\n        || m1[0].length !== m2[0].length) {\r\n        return false;\r\n    }\r\n    return !findAny(m1, function (col, x) {\r\n        return findAny(col, function (value, y) {\r\n            return value !== m2[x][y];\r\n        });\r\n    });\r\n}\r\nfunction mergeMatrixes(parent, child, target) {\r\n    if (target === void 0) { target = copyMatrix(parent); }\r\n    var childMatrix = child.matrix, position = child.position;\r\n    var result = target;\r\n    for (var i = 0; i < childMatrix.length; i++) {\r\n        for (var j = 0; j < childMatrix[0].length; j++) {\r\n            var value = childMatrix[i][j];\r\n            if (typeof value === 'undefined')\r\n                continue;\r\n            var x = i + position.x;\r\n            var y = j + position.y;\r\n            if (x >= 0 && x < parent.length &&\r\n                y >= 0 && y < parent[0].length &&\r\n                (value || !result[x][y])) {\r\n                result[x][y] = value;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction xyMatrix(matrix) {\r\n    return rotateMatrix(matrix)\r\n        .reduce(function (result, col, x) {\r\n        result[x] = col.reverse();\r\n        return result;\r\n    }, []);\r\n}\r\nfunction rotateMatrix(matrix, reverse) {\r\n    if (reverse === void 0) { reverse = false; }\r\n    var l = matrix.length;\r\n    var result = createMatrix({ width: l, height: l });\r\n    for (var x = 0; x < l; x++) {\r\n        for (var y = 0; y < l; y++) {\r\n            result[x][y] = reverse\r\n                ? matrix[l - y - 1][x]\r\n                : matrix[y][l - x - 1];\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction matrixContains(parent, child) {\r\n    var childMatrix = child.matrix, position = child.position;\r\n    for (var i = 0; i < childMatrix.length; i++) {\r\n        var col = childMatrix[i];\r\n        for (var j = 0; j < col.length; j++) {\r\n            if (!col[j])\r\n                continue;\r\n            var x = i + position.x;\r\n            var y = j + position.y;\r\n            if (x < 0 || x >= parent.length ||\r\n                y < 0 || y >= parent[0].length) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction matrixesColliding(parent, child) {\r\n    var childMatrix = child.matrix, position = child.position;\r\n    for (var x = 0; x < childMatrix.length; x++) {\r\n        for (var y = 0; y < childMatrix[0].length; y++) {\r\n            if (!childMatrix[x][y])\r\n                continue;\r\n            var col = parent[x + position.x];\r\n            if (!col)\r\n                continue;\r\n            if (col[y + position.y]) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction getUnstuckPosition(matrix, isColliding) {\r\n    var shape = matrix.matrix, position = matrix.position;\r\n    var maxOffset = Math.ceil(shape.length / 2);\r\n    for (var i = 1; i <= maxOffset; i++) {\r\n        var pos = clonePoint(position);\r\n        pos.y += i;\r\n        if (!isColliding({\r\n            matrix: shape,\r\n            position: pos\r\n        }))\r\n            return pos;\r\n        pos.y -= i * 2;\r\n        if (!isColliding({\r\n            matrix: shape,\r\n            position: pos\r\n        }))\r\n            return pos;\r\n        pos.y += i;\r\n        pos.x += i;\r\n        if (!isColliding({\r\n            matrix: shape,\r\n            position: pos\r\n        }))\r\n            return pos;\r\n        pos.x -= i * 2;\r\n        if (!isColliding({\r\n            matrix: shape,\r\n            position: pos\r\n        }))\r\n            return pos;\r\n        pos.x += i;\r\n    }\r\n    return null;\r\n}\r\n\n// CONCATENATED MODULE: ./src/components/panel.ts\n\r\n\r\n\r\nvar panel_Panel = (function () {\r\n    function Panel(id) {\r\n        var canvas = document.getElementById(id);\r\n        this.pixelRatio = devicePixelRatio || 1;\r\n        this.size = {\r\n            width: parseInt(canvas.getAttribute('width'), 10) * this.pixelRatio,\r\n            height: parseInt(canvas.getAttribute('height'), 10) * this.pixelRatio\r\n        };\r\n        if (this.size.width !== canvas.offsetWidth) {\r\n            canvas.setAttribute('width', \"\" + this.size.width);\r\n        }\r\n        if (this.size.height !== canvas.offsetHeight) {\r\n            canvas.setAttribute('height', \"\" + this.size.height);\r\n        }\r\n        var ctx = canvas.getContext('2d');\r\n        if (!ctx)\r\n            throw new Error('Context not found!');\r\n        this.ctx = ctx;\r\n    }\r\n    Panel.prototype.draw = function (matrix) {\r\n        this.clear();\r\n        drawGrid(this, getMatrixSize(matrix));\r\n        drawMatrix(this, matrix);\r\n    };\r\n    Panel.prototype.clear = function () {\r\n        this.ctx.clearRect(0, 0, this.size.width, this.size.height);\r\n    };\r\n    return Panel;\r\n}());\r\n/* harmony default export */ var components_panel = (panel_Panel);\r\n\n// CONCATENATED MODULE: ./src/models/board.ts\n\r\nvar board_Board = (function () {\r\n    function Board(size) {\r\n        this.size = size;\r\n        this.clear();\r\n    }\r\n    Object.defineProperty(Board.prototype, \"blocks\", {\r\n        get: function () { return this._blocks; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Board.prototype.place = function (shape, position) {\r\n        mergeMatrixes(this.blocks, {\r\n            matrix: shape.blocks,\r\n            position: position\r\n        }, this.blocks);\r\n    };\r\n    Board.prototype.clearFullLines = function () {\r\n        var _this = this;\r\n        var fullRows = this.getFullLines();\r\n        fullRows.forEach(function (row) { return _this.deleteRow(row); });\r\n        return fullRows.length;\r\n    };\r\n    Board.prototype.getFullLines = function () {\r\n        var rowCount = this._blocks[0].length;\r\n        var incompleteRows = new Array(rowCount - 1);\r\n        rows: for (var y = 0; y < rowCount; y++) {\r\n            for (var _i = 0, _a = this._blocks; _i < _a.length; _i++) {\r\n                var col = _a[_i];\r\n                if (!col[y]) {\r\n                    incompleteRows[y] = true;\r\n                    continue rows;\r\n                }\r\n            }\r\n        }\r\n        var result = [];\r\n        for (var row = 0; row < rowCount; row++) {\r\n            if (!incompleteRows[row])\r\n                result.push(row);\r\n        }\r\n        return result;\r\n    };\r\n    Board.prototype.deleteRow = function (row) {\r\n        this._blocks.forEach(function (col) {\r\n            col.splice(row, 1);\r\n            col.unshift(undefined);\r\n        });\r\n    };\r\n    Board.prototype.clear = function () {\r\n        this._blocks = [];\r\n        for (var x = 0; x < this.size.width; x++) {\r\n            this._blocks[x] = new Array(this.size.height);\r\n        }\r\n    };\r\n    Board.prototype.contains = function (matrix) {\r\n        return matrixContains(this._blocks, matrix);\r\n    };\r\n    Board.prototype.collides = function (matrix) {\r\n        return !this.contains(matrix)\r\n            || matrixesColliding(this.blocks, matrix);\r\n    };\r\n    return Board;\r\n}());\r\n/* harmony default export */ var models_board = (board_Board);\r\n\n// CONCATENATED MODULE: ./src/services/timer.ts\nvar Timer = (function () {\r\n    function Timer(handler, interval, repeat) {\r\n        if (repeat === void 0) { repeat = true; }\r\n        this._running = false;\r\n        this._handler = handler;\r\n        this._interval = interval;\r\n        this._repeat = repeat;\r\n    }\r\n    Object.defineProperty(Timer.prototype, \"running\", {\r\n        get: function () { return this._running; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Timer.prototype.start = function (executeOnInit) {\r\n        var _this = this;\r\n        if (executeOnInit === void 0) { executeOnInit = false; }\r\n        if (executeOnInit) {\r\n            this._handler();\r\n            if (!this._repeat)\r\n                return;\r\n        }\r\n        this.stop();\r\n        this._handle = (this._repeat\r\n            ? setInterval\r\n            : setTimeout)(function () {\r\n            _this._handler();\r\n            _this._running = false;\r\n        }, this._interval);\r\n        this._running = true;\r\n    };\r\n    Timer.prototype.stop = function () {\r\n        this._handle = (this._repeat\r\n            ? clearInterval\r\n            : clearTimeout)(this._handle);\r\n        this._running = false;\r\n    };\r\n    return Timer;\r\n}());\r\n/* harmony default export */ var timer = (Timer);\r\n\n// CONCATENATED MODULE: ./src/services/unique-array.ts\nvar UniqueArray = (function () {\r\n    function UniqueArray() {\r\n        this._array = [];\r\n    }\r\n    Object.defineProperty(UniqueArray.prototype, \"count\", {\r\n        get: function () { return this._array.length; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(UniqueArray.prototype, \"values\", {\r\n        get: function () { return this._array; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    UniqueArray.prototype.add = function (value) {\r\n        if (!this.contains(value)) {\r\n            this._array.push(value);\r\n        }\r\n    };\r\n    UniqueArray.prototype.remove = function (value) {\r\n        var index = this._array.indexOf(value);\r\n        if (index >= 0) {\r\n            this._array.splice(index, 1);\r\n        }\r\n    };\r\n    UniqueArray.prototype.contains = function (value) {\r\n        return this._array.indexOf(value) >= 0;\r\n    };\r\n    return UniqueArray;\r\n}());\r\n/* harmony default export */ var unique_array = (UniqueArray);\r\n\n// CONCATENATED MODULE: ./src/services/ghost-matrix.ts\n\r\nvar ghostColor = 8;\r\nfunction createGhost(board, pm) {\r\n    var matrix = pm.matrix;\r\n    var position = clonePoint(pm.position);\r\n    var y = position.y;\r\n    do {\r\n        y++;\r\n    } while (!board.collides({\r\n        matrix: matrix,\r\n        position: { x: position.x, y: y }\r\n    }));\r\n    position.y = y - 1;\r\n    var ghost = matrix.map(function (col) { return col.map(function (x) {\r\n        if (x)\r\n            return ghostColor;\r\n    }); });\r\n    return { matrix: ghost, position: position };\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/view-matrix.ts\n\r\n\r\n\r\nfunction getViewMatrix() {\r\n    var playerMatrix = {\r\n        matrix: storage_player.shape.blocks,\r\n        position: storage_player.position\r\n    };\r\n    var ghost = createGhost(storage_board, playerMatrix);\r\n    return mergeMatrixes(mergeMatrixes(storage_board.blocks, ghost), playerMatrix);\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/key-handling.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar keysDown = new unique_array();\r\nvar keyInterval = new timer(function () {\r\n    keysDown.values.forEach(function (code) {\r\n        handleKeyDown(code, true);\r\n    });\r\n}, 90);\r\nvar keyThresholdTimer = new timer(function () {\r\n    keyInterval.start();\r\n}, 200, false);\r\nfunction handleKeys() {\r\n    document.addEventListener('keydown', function (e) {\r\n        if (e.repeat)\r\n            return;\r\n        var keyCode = e.code;\r\n        if (handleKeyDown(keyCode, false)) {\r\n            e.preventDefault();\r\n            keysDown.add(keyCode);\r\n            if (keyCode === 'ArrowLeft' || keyCode === 'ArrowRight') {\r\n                keyInterval.stop();\r\n                keyThresholdTimer.start();\r\n            }\r\n            else\r\n                keyInterval.start();\r\n        }\r\n    });\r\n    document.addEventListener('keyup', function (e) {\r\n        if (keysDown.contains(e.code)) {\r\n            keysDown.remove(e.code);\r\n            if (keysDown.count === 0) {\r\n                keyThresholdTimer.stop();\r\n                keyInterval.stop();\r\n            }\r\n        }\r\n    });\r\n}\r\nfunction resetControls() {\r\n    keysDown.remove('ArrowDown');\r\n}\r\nfunction handleKeyDown(keyCode, repeated) {\r\n    var newPosition = {\r\n        x: storage_player.position.x,\r\n        y: storage_player.position.y\r\n    };\r\n    var beforeMatrix = copyMatrix(storage_player.shape.blocks);\r\n    var triggered = true;\r\n    var hardDropped = false;\r\n    switch (keyCode) {\r\n        case 'ArrowUp':\r\n            if (repeated)\r\n                return true;\r\n            storage_player.shape.rotate();\r\n            var playerMatrix = {\r\n                matrix: storage_player.shape.blocks,\r\n                position: newPosition\r\n            };\r\n            if (storage_board.collides(playerMatrix)) {\r\n                var unstuckPos = getUnstuckPosition(playerMatrix, storage_board.collides.bind(storage_board));\r\n                if (!unstuckPos) {\r\n                    storage_player.shape.rotate(true);\r\n                }\r\n                else {\r\n                    newPosition = unstuckPos;\r\n                }\r\n            }\r\n            break;\r\n        case 'ArrowRight':\r\n            newPosition.x++;\r\n            break;\r\n        case 'ArrowDown':\r\n            newPosition.y++;\r\n            var sdPoints = src_settings.points.softDrop;\r\n            storage_player.softDropPoints += sdPoints;\r\n            if (storage_player.softDropPoints < src_settings.points.softDropMax) {\r\n                addScore(sdPoints);\r\n            }\r\n            break;\r\n        case 'ArrowLeft':\r\n            newPosition.x--;\r\n            break;\r\n        case 'Space':\r\n            if (repeated)\r\n                return true;\r\n            var nextPos = newPosition;\r\n            var hdPoints = 0;\r\n            do {\r\n                nextPos = { x: nextPos.x, y: nextPos.y + 1 };\r\n                hdPoints += src_settings.points.hardDrop;\r\n            } while (!storage_board.collides({\r\n                matrix: storage_player.shape.blocks,\r\n                position: nextPos\r\n            }));\r\n            newPosition = { x: nextPos.x, y: nextPos.y - 1 };\r\n            addScore(Math.min(hdPoints - src_settings.points.hardDrop, src_settings.points.hardDropMax));\r\n            hardDropped = true;\r\n            break;\r\n        default:\r\n            triggered = false;\r\n            break;\r\n    }\r\n    var posChanged = !pointEquals(storage_player.position, newPosition);\r\n    if (posChanged || hardDropped) {\r\n        var newMatrix = {\r\n            matrix: storage_player.shape.blocks,\r\n            position: newPosition\r\n        };\r\n        if (!storage_board.collides(newMatrix)) {\r\n            storage_player.position = newPosition;\r\n        }\r\n        else\r\n            posChanged = false;\r\n        if (hardDropped\r\n            || keyCode === 'ArrowDown'\r\n                && storage_board.collides(newMatrix)) {\r\n            placePiece();\r\n        }\r\n    }\r\n    var rotationChanged = !matrixEquals(storage_player.shape.blocks, beforeMatrix);\r\n    if (posChanged || rotationChanged) {\r\n        stopLockTimeout();\r\n        storage_panel.draw(getViewMatrix());\r\n    }\r\n    return triggered;\r\n}\r\n\n// CONCATENATED MODULE: ./src/models/shape.ts\n\r\nvar shape_Shape = (function () {\r\n    function Shape(blocks) {\r\n        this._blocks = blocks;\r\n    }\r\n    Object.defineProperty(Shape.prototype, \"blocks\", {\r\n        get: function () {\r\n            return this._blocks;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Shape.prototype.rotate = function (reverse) {\r\n        if (reverse === void 0) { reverse = false; }\r\n        this._blocks = rotateMatrix(this._blocks, reverse);\r\n    };\r\n    return Shape;\r\n}());\r\n/* harmony default export */ var models_shape = (shape_Shape);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/i.ts\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar c = 2;\r\nvar i_I = (function (_super) {\r\n    __extends(I, _super);\r\n    function I() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return I;\r\n}(models_shape));\r\n/* harmony default export */ var shapes_i = (i_I);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/j.ts\nvar j___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar j_c = 6;\r\nvar j_J = (function (_super) {\r\n    j___extends(J, _super);\r\n    function J() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, j_c, 0],\r\n            [0, j_c, 0],\r\n            [j_c, j_c, 0]\r\n        ])) || this;\r\n    }\r\n    return J;\r\n}(models_shape));\r\n/* harmony default export */ var j = (j_J);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/l.ts\nvar l___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar l_c = 5;\r\nvar l_L = (function (_super) {\r\n    l___extends(L, _super);\r\n    function L() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, l_c, 0],\r\n            [0, l_c, 0],\r\n            [0, l_c, l_c]\r\n        ])) || this;\r\n    }\r\n    return L;\r\n}(models_shape));\r\n/* harmony default export */ var l = (l_L);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/o.ts\nvar o___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar o_c = 1;\r\nvar o_O = (function (_super) {\r\n    o___extends(O, _super);\r\n    function O() {\r\n        return _super.call(this, xyMatrix([\r\n            [o_c, o_c],\r\n            [o_c, o_c]\r\n        ])) || this;\r\n    }\r\n    return O;\r\n}(models_shape));\r\n/* harmony default export */ var o = (o_O);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/s.ts\nvar s___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar s_c = 3;\r\nvar s_S = (function (_super) {\r\n    s___extends(S, _super);\r\n    function S() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, s_c, s_c],\r\n            [s_c, s_c, 0],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return S;\r\n}(models_shape));\r\n/* harmony default export */ var s = (s_S);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/t.ts\nvar t___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar t_c = 7;\r\nvar t_T = (function (_super) {\r\n    t___extends(T, _super);\r\n    function T() {\r\n        return _super.call(this, xyMatrix([\r\n            [t_c, t_c, t_c],\r\n            [0, t_c, 0],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return T;\r\n}(models_shape));\r\n/* harmony default export */ var t = (t_T);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/z.ts\nvar z___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar z_c = 4;\r\nvar z_Z = (function (_super) {\r\n    z___extends(Z, _super);\r\n    function Z() {\r\n        return _super.call(this, xyMatrix([\r\n            [z_c, z_c, 0],\r\n            [0, z_c, z_c],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return Z;\r\n}(models_shape));\r\n/* harmony default export */ var z = (z_Z);\r\n\n// CONCATENATED MODULE: ./src/services/random-shape.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar shapes = [shapes_i, j, l, o, s, t, z];\r\nfunction getRandomShape() {\r\n    var Shape = shapes[Math.floor(Math.random() * shapes.length)];\r\n    return new Shape();\r\n}\r\n\n// CONCATENATED MODULE: ./src/models/player.ts\n\r\n\r\n\r\nvar player_Player = (function () {\r\n    function Player(startingPosition) {\r\n        this.softDropPoints = 0;\r\n        this._startingPos = startingPosition;\r\n        this.reset();\r\n    }\r\n    Object.defineProperty(Player.prototype, \"shape\", {\r\n        get: function () {\r\n            return this._shape;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Player.prototype.reset = function () {\r\n        this.position = clonePoint(this._startingPos);\r\n        this._shape = getRandomShape();\r\n        resetControls();\r\n        this.softDropPoints = 0;\r\n    };\r\n    return Player;\r\n}());\r\n/* harmony default export */ var player = (player_Player);\r\n\n// CONCATENATED MODULE: ./src/services/storage.ts\n\r\n\r\n\r\nvar boardSize = {\r\n    width: 10,\r\n    height: 20\r\n};\r\nvar storage_player = new player({ x: boardSize.width / 2 - 1, y: 0 });\r\nvar storage_panel = new components_panel('game');\r\nvar storage_board = new models_board(boardSize);\r\n\n// CONCATENATED MODULE: ./src/services/game-over.ts\n\r\n\r\nfunction gameOver() {\r\n    storage_board.clear();\r\n    storage_player.reset();\r\n    resetScore();\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/gameloop.ts\n\r\n\r\n\r\n\r\n\r\n\r\nfunction placePiece() {\r\n    storage_board.place(storage_player.shape, storage_player.position);\r\n    var linesCleared = storage_board.clearFullLines();\r\n    if (linesCleared) {\r\n        var scoring = src_settings.points.linesCleared;\r\n        addScore(scoring[linesCleared]);\r\n    }\r\n    storage_player.reset();\r\n    if (storage_board.collides({\r\n        matrix: storage_player.shape.blocks,\r\n        position: storage_player.position\r\n    }))\r\n        gameOver();\r\n}\r\nvar lockTimeout = new timer(placePiece, src_settings.placementTimeout * 1000, false);\r\nfunction stopLockTimeout() {\r\n    lockTimeout.stop();\r\n}\r\nfunction update() {\r\n    var newPos = {\r\n        x: storage_player.position.x,\r\n        y: storage_player.position.y + 1\r\n    };\r\n    if (!storage_board.collides({ matrix: storage_player.shape.blocks, position: newPos })) {\r\n        storage_player.position = newPos;\r\n    }\r\n    else {\r\n        lockTimeout.start();\r\n    }\r\n    storage_panel.draw(getViewMatrix());\r\n}\r\nvar interval;\r\nvar currentSeconds;\r\nfunction setLoopSpeed(seconds) {\r\n    currentSeconds = seconds;\r\n    window.clearInterval(interval);\r\n    update();\r\n    interval = window.setInterval(function () {\r\n        if (!lockTimeout.running)\r\n            update();\r\n    }, seconds * 1000);\r\n}\r\n\n// EXTERNAL MODULE: ./src/vendor/modernizr.min.js\nvar modernizr_min = __webpack_require__(1);\nvar modernizr_min_default = /*#__PURE__*/__webpack_require__.n(modernizr_min);\n\n// CONCATENATED MODULE: ./src/index.ts\n\r\n\r\n\r\n\r\n\r\nsetLoopSpeed(src_settings.gameSpeed);\r\nhandleKeys();\r\nloadPlayerScore();\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n/*! modernizr 3.5.0 (Custom Build) | MIT *\r\n * https://modernizr.com/download/?-canvas-localstorage-serviceworker-sessionstorage-touchevents-webgl !*/\r\n!function(e,t,n){function o(e,t){return typeof e===t}function r(){var e,t,n,r,s,a,i;for(var d in l)if(l.hasOwnProperty(d)){if(e=[],t=l[d],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(r=o(t.fn,\"function\")?t.fn():t.fn,s=0;s<e.length;s++)a=e[s],i=a.split(\".\"),1===i.length?Modernizr[i[0]]=r:(!Modernizr[i[0]]||Modernizr[i[0]]instanceof Boolean||(Modernizr[i[0]]=new Boolean(Modernizr[i[0]])),Modernizr[i[0]][i[1]]=r),c.push((r?\"\":\"no-\")+i.join(\"-\"))}}function s(){return\"function\"!=typeof t.createElement?t.createElement(arguments[0]):u?t.createElementNS.call(t,\"http://www.w3.org/2000/svg\",arguments[0]):t.createElement.apply(t,arguments)}function a(){var e=t.body;return e||(e=s(u?\"svg\":\"body\"),e.fake=!0),e}function i(e,n,o,r){var i,l,d,c,u=\"modernizr\",p=s(\"div\"),v=a();if(parseInt(o,10))for(;o--;)d=s(\"div\"),d.id=r?r[o]:u+(o+1),p.appendChild(d);return i=s(\"style\"),i.type=\"text/css\",i.id=\"s\"+u,(v.fake?v:p).appendChild(i),v.appendChild(p),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),p.id=u,v.fake&&(v.style.background=\"\",v.style.overflow=\"hidden\",c=f.style.overflow,f.style.overflow=\"hidden\",f.appendChild(v)),l=n(p,e),v.fake?(v.parentNode.removeChild(v),f.style.overflow=c,f.offsetHeight):p.parentNode.removeChild(p),!!l}var l=[],d={_version:\"3.5.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){l.push({name:e,fn:t,options:n})},addAsyncTest:function(e){l.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=d,Modernizr=new Modernizr,Modernizr.addTest(\"serviceworker\",\"serviceWorker\"in navigator),Modernizr.addTest(\"localstorage\",function(){var e=\"modernizr\";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}),Modernizr.addTest(\"sessionstorage\",function(){var e=\"modernizr\";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}});var c=[],f=t.documentElement,u=\"svg\"===f.nodeName.toLowerCase();Modernizr.addTest(\"canvas\",function(){var e=s(\"canvas\");return!(!e.getContext||!e.getContext(\"2d\"))}),Modernizr.addTest(\"webgl\",function(){var t=s(\"canvas\"),n=\"probablySupportsContext\"in t?\"probablySupportsContext\":\"supportsContext\";return n in t?t[n](\"webgl\")||t[n](\"experimental-webgl\"):\"WebGLRenderingContext\"in e});var p=d._config.usePrefixes?\" -webkit- -moz- -o- -ms- \".split(\" \"):[\"\",\"\"];d._prefixes=p;var v=d.testStyles=i;Modernizr.addTest(\"touchevents\",function(){var n;if(\"ontouchstart\"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var o=[\"@media (\",p.join(\"touch-enabled),(\"),\"heartz\",\")\",\"{#modernizr{top:9px;position:absolute}}\"].join(\"\");v(o,function(e){n=9===e.offsetTop})}return n}),r(),delete d.addTest,delete d.addAsyncTest;for(var m=0;m<Modernizr._q.length;m++)Modernizr._q[m]();e.Modernizr=Modernizr}(window,document);\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a8ef5fa0f3255c995aa2","let currentScore = 0;\r\n\r\nexport function addScore(points: number): void {\r\n    currentScore += points;\r\n    triggerScoreChange();\r\n}\r\n\r\nexport function resetScore(): void {\r\n    currentScore = 0;\r\n    triggerScoreChange();\r\n}\r\n\r\nconst subscribers: Array<(score: number) => void> = [];\r\nexport function onScoreChange(handler: (score: number) => void, triggerOnInit = false): void {\r\n    subscribers.push(handler);\r\n    if (triggerOnInit) handler(currentScore);\r\n}\r\n\r\nfunction triggerScoreChange(): void {\r\n    subscribers.forEach(handler => handler(currentScore));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/player-score.ts","import Panel from '../components/panel';\r\nimport { ISize } from '../interfaces/size';\r\n\r\nexport default function drawGrid(panel: Panel, gridSize: ISize): void {\r\n    const tileSize: ISize = {\r\n        width: panel.size.width / gridSize.width,\r\n        height: panel.size.height / gridSize.height\r\n    };\r\n\r\n    const { ctx } = panel;\r\n    ctx.strokeStyle = '#efefef';\r\n    ctx.lineWidth = panel.pixelRatio;\r\n\r\n    for (let x = 0; x < panel.size.width; x += tileSize.width) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, 0);\r\n        ctx.lineTo(x, panel.size.height);\r\n        ctx.stroke();\r\n    }\r\n\r\n    for (let y = 0; y < panel.size.height; y += tileSize.height) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, y);\r\n        ctx.lineTo(panel.size.width, y);\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/draw-grid.ts","export const enum Color {\r\n    Yellow = 1,\r\n    Blue = 2,\r\n    Red = 3,\r\n    Green = 4,\r\n    Orange = 5,\r\n    Pink = 6,\r\n    Purple = 7,\r\n    Grey = 8\r\n}\r\n\r\nexport function getColorCode(color: Color): string {\r\n    switch (color) {\r\n        case Color.Yellow:\r\n            return '#ffeb3b';\r\n        case Color.Blue:\r\n            return '#03a9f4';\r\n        case Color.Red:\r\n            return '#f44336';\r\n        case Color.Green:\r\n            return '#4caf50';\r\n        case Color.Orange:\r\n            return '#ff9800';\r\n        case Color.Pink:\r\n            return '#fbafbc';\r\n        case Color.Purple:\r\n            return '#9c27b0';\r\n        case Color.Grey:\r\n            return '#e0e0e0';\r\n        default:\r\n            return '#000';\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/color.ts","import Panel from '../components/panel';\r\nimport Matrix from '../interfaces/matrix';\r\nimport { ISize } from '../interfaces/size';\r\nimport { getColorCode } from '../models/color';\r\nimport settings from '../settings';\r\n\r\nconst emptyColor = settings.debug.emptyTileColor;\r\n\r\nexport default function drawMatrix(panel: Panel, matrix: Matrix): void {\r\n    const ctx = panel.ctx;\r\n\r\n    const tileSize: ISize = {\r\n        width: panel.size.width / matrix.length,\r\n        height: panel.size.height / matrix[0].length\r\n    };\r\n\r\n    matrix.forEach((col, x) => col.forEach((item, y) => {\r\n        if (typeof item === 'undefined' ||\r\n            !settings.debug.drawEmptyTiles && !item) return;\r\n\r\n        ctx.fillStyle = item ? getColorCode(item) : emptyColor;\r\n        ctx.fillRect(\r\n            x * tileSize.width | 0,\r\n            y * tileSize.height | 0,\r\n            Math.ceil(tileSize.width),\r\n            Math.ceil(tileSize.height));\r\n    }));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/draw-matrix.ts","export default interface IPoint {\r\n    x: number;\r\n    y: number;\r\n}\r\n\r\nexport function clonePoint(point: IPoint): IPoint {\r\n    return { x: point.x, y: point.y };\r\n}\r\n\r\nexport function pointEquals(a: IPoint, b: IPoint): boolean {\r\n    return a.x === b.x && a.y === b.y;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/interfaces/point.ts","export function findIndex<T>(array: T[], predicate: (item: T, index: number) => boolean): number | undefined {\r\n    for (let i = 0; i < array.length; i++) {\r\n        const value = array[i];\r\n        if (predicate(value, i)) {\r\n            return i;\r\n        }\r\n    }\r\n}\r\n\r\nexport function findAny<T>(array: T[], predicate: (item: T, index: number) => boolean): boolean {\r\n    return typeof findIndex(array, predicate) !== 'undefined';\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/arrays.ts","import Matrix from '../interfaces/matrix';\r\nimport { clonePoint, default as IPoint } from '../interfaces/point';\r\nimport IPositionedMatrix from '../interfaces/positioned-matrix';\r\nimport { ISize } from '../interfaces/size';\r\nimport { findAny } from './arrays';\r\n\r\nexport function createMatrix(size: ISize): Matrix {\r\n    const result: Matrix = [];\r\n    for (let col = 0; col < size.width; col++) {\r\n        result[col] = new Array(size.height);\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function copyMatrix(matrix: Matrix): Matrix {\r\n    return matrix.reduce<Matrix>((result, col, x) => {\r\n        result[x] = col.slice();\r\n        return result;\r\n    }, []);\r\n}\r\n\r\nexport function getMatrixSize(matrix: Matrix): ISize {\r\n    return {\r\n        width: matrix.length,\r\n        height: matrix[0].length\r\n    };\r\n}\r\n\r\nexport function matrixEquals(m1: Matrix, m2: Matrix): boolean {\r\n    if (m1.length !== m2.length\r\n        || m1[0].length !== m2[0].length) {\r\n        return false;\r\n    }\r\n\r\n    return !findAny(m1, (col, x) => {\r\n        return findAny(col, (value, y) => {\r\n            return value !== m2[x][y];\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Merges parent and child matrixes into the target matrix\r\n */\r\nexport function mergeMatrixes(parent: Matrix, child: IPositionedMatrix, target = copyMatrix(parent)): Matrix {\r\n    const { matrix: childMatrix, position } = child;\r\n    const result = target;\r\n\r\n    for (let i = 0; i < childMatrix.length; i++) {\r\n        for (let j = 0; j < childMatrix[0].length; j++) {\r\n            const value = childMatrix[i][j];\r\n            if (typeof value === 'undefined') continue;\r\n\r\n            const x = i + position.x;\r\n            const y = j + position.y;\r\n\r\n            if (x >= 0 && x < parent.length &&\r\n                y >= 0 && y < parent[0].length &&\r\n                (value || !result[x][y])) {\r\n                result[x][y] = value;\r\n            }\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Transforms matrix to be used in the coordinate system\r\n */\r\nexport function xyMatrix(matrix: Matrix): Matrix {\r\n    return rotateMatrix(matrix)\r\n        .reduce<Matrix>((result, col, x) => {\r\n            // Flip columns\r\n            result[x] = col.reverse();\r\n            return result;\r\n        }, []);\r\n}\r\n\r\n/**\r\n * Rotate a square 2D matrix\r\n */\r\nexport function rotateMatrix(matrix: Matrix, reverse = false): Matrix {\r\n    const l = matrix.length;\r\n    const result = createMatrix({ width: l, height: l });\r\n\r\n    // Apply rotation\r\n    for (let x = 0; x < l; x++) {\r\n        for (let y = 0; y < l; y++) {\r\n            result[x][y] = reverse\r\n                ? matrix[l - y - 1][x]\r\n                : matrix[y][l - x - 1];\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Checks if child is not outside parent matrix\r\n */\r\nexport function matrixContains(parent: Matrix, child: IPositionedMatrix): boolean {\r\n    const { matrix: childMatrix, position } = child;\r\n\r\n    for (let i = 0; i < childMatrix.length; i++) {\r\n        const col = childMatrix[i];\r\n        for (let j = 0; j < col.length; j++) {\r\n            if (!col[j]) continue;\r\n\r\n            const x = i + position.x;\r\n            const y = j + position.y;\r\n\r\n            if (x < 0 || x >= parent.length ||\r\n                y < 0 || y >= parent[0].length) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nexport function matrixesColliding(parent: Matrix, child: IPositionedMatrix): boolean {\r\n    const { matrix: childMatrix, position } = child;\r\n\r\n    for (let x = 0; x < childMatrix.length; x++) {\r\n        for (let y = 0; y < childMatrix[0].length; y++) {\r\n            if (!childMatrix[x][y]) continue;\r\n\r\n            const col = parent[x + position.x];\r\n            if (!col) continue;\r\n\r\n            if (col[y + position.y]) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Tries to move matrix to a non-colliding position\r\n */\r\nexport function getUnstuckPosition(matrix: IPositionedMatrix,\r\n    isColliding: (matrix: IPositionedMatrix) => boolean): IPoint | null {\r\n\r\n    const { matrix: shape, position } = matrix;\r\n\r\n    const maxOffset = Math.ceil(shape.length / 2);\r\n    for (let i = 1; i <= maxOffset; i++) {\r\n        const pos = clonePoint(position);\r\n\r\n        // Try down\r\n        pos.y += i;\r\n        if (!isColliding({\r\n            matrix: shape,\r\n            position: pos\r\n        })) return pos;\r\n\r\n        // Try up\r\n        pos.y -= i * 2;\r\n        if (!isColliding({\r\n            matrix: shape,\r\n            position: pos\r\n        })) return pos;\r\n        pos.y += i;\r\n\r\n        // Try right\r\n        pos.x += i;\r\n        if (!isColliding({\r\n            matrix: shape,\r\n            position: pos\r\n        })) return pos;\r\n\r\n        // Try left\r\n        pos.x -= i * 2;\r\n        if (!isColliding({\r\n            matrix: shape,\r\n            position: pos\r\n        })) return pos;\r\n        pos.x += i;\r\n    }\r\n\r\n    return null;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/matrix-calculations.ts","import Matrix from '../interfaces/matrix';\r\nimport { clonePoint } from '../interfaces/point';\r\nimport IPositionedMatrix from '../interfaces/positioned-matrix';\r\nimport Board from '../models/board';\r\nimport { Color } from '../models/color';\r\n\r\nconst ghostColor = Color.Grey;\r\n\r\nexport default function createGhost(board: Board, pm: IPositionedMatrix): IPositionedMatrix {\r\n    const matrix = pm.matrix;\r\n    const position = clonePoint(pm.position);\r\n\r\n    // Calculate y position\r\n    let y = position.y;\r\n    do {\r\n        y++;\r\n    } while (!board.collides({\r\n        matrix,\r\n        position: { x: position.x, y }\r\n    }));\r\n    position.y = y - 1;\r\n\r\n    // Copy matrix with new color\r\n    const ghost: Matrix = matrix.map(col => col.map(x => {\r\n        if (x) return ghostColor;\r\n    }));\r\n\r\n    return { matrix: ghost, position };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/ghost-matrix.ts","import Matrix from '../interfaces/matrix';\r\nimport createGhost from './ghost-matrix';\r\nimport { mergeMatrixes } from './matrix-calculations';\r\nimport { board, player } from './storage';\r\n\r\nexport default function getViewMatrix(): Matrix {\r\n\r\n    const playerMatrix = {\r\n        matrix: player.shape.blocks,\r\n        position: player.position\r\n    };\r\n\r\n    const ghost = createGhost(board, playerMatrix);\r\n\r\n    return mergeMatrixes(\r\n        mergeMatrixes(board.blocks, ghost),\r\n        playerMatrix\r\n    );\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/view-matrix.ts","import { pointEquals } from '../interfaces/point';\r\nimport settings from '../settings';\r\nimport { placePiece, stopLockTimeout } from './gameloop';\r\nimport { copyMatrix, getUnstuckPosition, matrixEquals } from './matrix-calculations';\r\nimport { addScore } from './player-score';\r\nimport { board, panel, player } from './storage';\r\nimport Timer from './timer';\r\nimport UniqueArray from './unique-array';\r\nimport getViewMatrix from './view-matrix';\r\n\r\nconst keysDown = new UniqueArray<string>();\r\n\r\nconst keyInterval = new Timer(() => {\r\n    keysDown.values.forEach(code => {\r\n        handleKeyDown(code, true);\r\n    });\r\n}, 90);\r\n\r\nconst keyThresholdTimer = new Timer(() => {\r\n    keyInterval.start();\r\n}, 200, false);\r\n\r\nexport default function handleKeys(): void {\r\n    document.addEventListener('keydown', e => {\r\n        if (e.repeat) return;\r\n\r\n        const keyCode = e.code;\r\n\r\n        if (handleKeyDown(keyCode, false)) {\r\n            e.preventDefault();\r\n\r\n            keysDown.add(keyCode);\r\n\r\n            if (keyCode === 'ArrowLeft' || keyCode === 'ArrowRight') {\r\n                // Make it easier to move one tile\r\n                keyInterval.stop();\r\n                keyThresholdTimer.start();\r\n            } else keyInterval.start();\r\n        }\r\n    });\r\n\r\n    document.addEventListener('keyup', e => {\r\n        if (keysDown.contains(e.code)) {\r\n            keysDown.remove(e.code);\r\n\r\n            if (keysDown.count === 0) {\r\n                keyThresholdTimer.stop();\r\n                keyInterval.stop();\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nexport function resetControls(): void {\r\n    keysDown.remove('ArrowDown');\r\n}\r\n\r\nfunction handleKeyDown(keyCode: string, repeated: boolean): boolean {\r\n    let newPosition = {\r\n        x: player.position.x,\r\n        y: player.position.y\r\n    };\r\n\r\n    const beforeMatrix = copyMatrix(player.shape.blocks);\r\n\r\n    let triggered = true;\r\n    let hardDropped = false;\r\n\r\n    switch (keyCode) {\r\n        case 'ArrowUp':\r\n            // Rotate clockwise\r\n            if (repeated) return true;\r\n            player.shape.rotate();\r\n\r\n            const playerMatrix = {\r\n                matrix: player.shape.blocks,\r\n                position: newPosition\r\n            };\r\n\r\n            if (board.collides(playerMatrix)) {\r\n                // Colliding with other blocks, try to reposition\r\n                const unstuckPos = getUnstuckPosition(playerMatrix, board.collides.bind(board));\r\n\r\n                if (!unstuckPos) {\r\n                    // Cannot unstuck, revert!\r\n                    player.shape.rotate(true);\r\n                } else {\r\n                    // Repositioned\r\n                    newPosition = unstuckPos;\r\n                }\r\n            }\r\n\r\n            break;\r\n        case 'ArrowRight':\r\n            // Move right\r\n            newPosition.x++;\r\n            break;\r\n        case 'ArrowDown':\r\n            // Soft drop\r\n            newPosition.y++;\r\n\r\n            // Add points to score\r\n            const sdPoints = settings.points.softDrop;\r\n            player.softDropPoints += sdPoints;\r\n            if (player.softDropPoints < settings.points.softDropMax) {\r\n                addScore(sdPoints);\r\n            }\r\n\r\n            break;\r\n        case 'ArrowLeft':\r\n            // Move left\r\n            newPosition.x--;\r\n            break;\r\n        case 'Space':\r\n            // Hard drop\r\n            if (repeated) return true;\r\n\r\n            let nextPos = newPosition;\r\n            let hdPoints = 0;\r\n\r\n            do {\r\n                nextPos = { x: nextPos.x, y: nextPos.y + 1 };\r\n                hdPoints += settings.points.hardDrop;\r\n            } while (!board.collides({\r\n                matrix: player.shape.blocks,\r\n                position: nextPos\r\n            }));\r\n\r\n            newPosition = { x: nextPos.x, y: nextPos.y - 1 };\r\n            addScore(Math.min(\r\n                hdPoints - settings.points.hardDrop,\r\n                settings.points.hardDropMax));\r\n\r\n            hardDropped = true;\r\n            break;\r\n        default:\r\n            triggered = false;\r\n            break;\r\n    }\r\n\r\n    let posChanged = !pointEquals(player.position, newPosition);\r\n\r\n    if (posChanged || hardDropped) {\r\n        const newMatrix = {\r\n            matrix: player.shape.blocks,\r\n            position: newPosition\r\n        };\r\n\r\n        if (!board.collides(newMatrix)) {\r\n            player.position = newPosition;\r\n        } else posChanged = false;\r\n\r\n        if (hardDropped\r\n            || keyCode === 'ArrowDown'\r\n            && board.collides(newMatrix)) {\r\n            placePiece();\r\n        }\r\n    }\r\n\r\n    const rotationChanged = !matrixEquals(player.shape.blocks, beforeMatrix);\r\n\r\n    if (posChanged || rotationChanged) {\r\n        stopLockTimeout();\r\n        panel.draw(getViewMatrix());\r\n    }\r\n\r\n    return triggered;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/key-handling.ts","import I from '../models/shapes/i';\r\nimport J from '../models/shapes/j';\r\nimport L from '../models/shapes/l';\r\nimport O from '../models/shapes/o';\r\nimport S from '../models/shapes/s';\r\nimport T from '../models/shapes/t';\r\nimport Z from '../models/shapes/z';\r\n\r\nconst shapes = [I, J, L, O, S, T, Z];\r\n\r\nexport default function getRandomShape() {\r\n    const Shape = shapes[Math.floor(Math.random() * shapes.length)];\r\n    return new Shape();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/random-shape.ts","import { resetScore } from './player-score';\r\nimport { board, player } from './storage';\r\n\r\nexport default function gameOver(): void {\r\n    board.clear();\r\n    player.reset();\r\n    resetScore();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/game-over.ts","import settings from '../settings';\r\nimport gameOver from './game-over';\r\nimport { addScore } from './player-score';\r\nimport { board, panel, player } from './storage';\r\nimport Timer from './timer';\r\nimport getViewMatrix from './view-matrix';\r\n\r\nexport function placePiece(): void {\r\n    board.place(player.shape, player.position);\r\n    const linesCleared = board.clearFullLines();\r\n\r\n    // Add points for cleared lines\r\n    if (linesCleared) {\r\n        const scoring = settings.points.linesCleared as { [lines: number]: number };\r\n        addScore(scoring[linesCleared]);\r\n    }\r\n\r\n    player.reset();\r\n\r\n    // Detect immediate collision\r\n    if (board.collides({\r\n        matrix: player.shape.blocks,\r\n        position: player.position\r\n    })) gameOver();\r\n}\r\n\r\nconst lockTimeout = new Timer(placePiece, settings.placementTimeout * 1000, false);\r\n\r\nexport function stopLockTimeout(): void {\r\n    lockTimeout.stop();\r\n}\r\n\r\nfunction update(): void {\r\n    const newPos = {\r\n        x: player.position.x,\r\n        y: player.position.y + 1\r\n    };\r\n\r\n    if (!board.collides({ matrix: player.shape.blocks, position: newPos })) {\r\n        // Move piece down\r\n        player.position = newPos;\r\n    } else {\r\n        // Colliding, init placement\r\n        lockTimeout.start();\r\n    }\r\n\r\n    panel.draw(getViewMatrix());\r\n}\r\n\r\n// Call update immediately\r\nlet interval: number;\r\nlet currentSeconds: number;\r\nexport function setLoopSpeed(seconds: number): void {\r\n    currentSeconds = seconds;\r\n\r\n    window.clearInterval(interval);\r\n    update();\r\n    interval = window.setInterval(() => {\r\n        if (!lockTimeout.running) update();\r\n    }, seconds * 1000);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/gameloop.ts","import { onScoreChange } from '../services/player-score';\r\n\r\nlet scoreEl: HTMLSpanElement;\r\n\r\nexport default function loadPlayerScore(): void {\r\n    scoreEl = document.getElementById('player-score') as HTMLSpanElement;\r\n    onScoreChange(score => {\r\n        scoreEl.textContent = score.toLocaleString();\r\n    }, true);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/components/player-score.ts","const settings = {\r\n\r\n    // Per drops per second\r\n    gameSpeed: 0.4,\r\n\r\n    points: {\r\n        // Amount of lines cleared at once\r\n        linesCleared: {\r\n            1: 40,\r\n            2: 100,\r\n            3: 300,\r\n            4: 1200\r\n        },\r\n\r\n        // Points per cell dropped\r\n        softDrop: 1,\r\n        hardDrop: 2,\r\n\r\n        // Max drop points per turn\r\n        softDropMax: 20,\r\n        hardDropMax: 40\r\n    },\r\n\r\n    // Seconds to wait before locking piece\r\n    placementTimeout: 0.5,\r\n\r\n    debug: {\r\n        // Draw full shape square\r\n        drawEmptyTiles: false,\r\n        emptyTileColor: '#f1f1f1'\r\n    }\r\n};\r\n\r\nexport default settings;\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/settings.ts","import Matrix from '../interfaces/matrix';\r\nimport { ISize } from '../interfaces/size';\r\nimport drawGrid from '../services/draw-grid';\r\nimport drawMatrix from '../services/draw-matrix';\r\nimport { getMatrixSize } from '../services/matrix-calculations';\r\n\r\nexport default class Panel {\r\n    public readonly ctx: CanvasRenderingContext2D;\r\n    public readonly size: ISize;\r\n    public readonly pixelRatio: number;\r\n\r\n    constructor(id: string) {\r\n        const canvas = document.getElementById(id) as HTMLCanvasElement;\r\n        this.pixelRatio = devicePixelRatio || 1;\r\n\r\n        // Read canvas size\r\n        this.size = {\r\n            width: parseInt(canvas.getAttribute('width') as string, 10) * this.pixelRatio,\r\n            height: parseInt(canvas.getAttribute('height') as string, 10) * this.pixelRatio\r\n        };\r\n\r\n        // Fix scaling for small viewports\r\n        if (this.size.width !== canvas.offsetWidth) {\r\n            canvas.setAttribute('width', `${this.size.width}`);\r\n        }\r\n\r\n        if (this.size.height !== canvas.offsetHeight) {\r\n            canvas.setAttribute('height', `${this.size.height}`);\r\n        }\r\n\r\n        // Get drawing context\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) throw new Error('Context not found!');\r\n        this.ctx = ctx;\r\n    }\r\n\r\n    public draw(matrix: Matrix): void {\r\n        this.clear();\r\n        drawGrid(this, getMatrixSize(matrix));\r\n        drawMatrix(this, matrix);\r\n    }\r\n\r\n    private clear(): void {\r\n        this.ctx.clearRect(0, 0, this.size.width, this.size.height);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/components/panel.ts","import Matrix from '../interfaces/matrix';\r\nimport IPoint from '../interfaces/point';\r\nimport IPositionedMatrix from '../interfaces/positioned-matrix';\r\nimport { ISize } from '../interfaces/size';\r\nimport { matrixContains, matrixesColliding, mergeMatrixes } from '../services/matrix-calculations';\r\nimport Shape from './shape';\r\n\r\nexport default class Board {\r\n    private _blocks: Matrix;\r\n    public get blocks() { return this._blocks; }\r\n\r\n    public readonly size: ISize;\r\n\r\n    constructor(size: ISize) {\r\n        this.size = size;\r\n        this.clear();\r\n    }\r\n\r\n    public place(shape: Shape, position: IPoint): void {\r\n        mergeMatrixes(this.blocks, {\r\n            matrix: shape.blocks,\r\n            position\r\n        }, this.blocks);\r\n    }\r\n\r\n    public clearFullLines(): number {\r\n        const fullRows = this.getFullLines();\r\n        fullRows.forEach(row => this.deleteRow(row));\r\n        return fullRows.length;\r\n    }\r\n\r\n    private getFullLines(): number[] {\r\n        const rowCount = this._blocks[0].length;\r\n        const incompleteRows = new Array<boolean>(rowCount - 1);\r\n\r\n        rows:\r\n        for (let y = 0; y < rowCount; y++) {\r\n            for (const col of this._blocks) {\r\n                if (!col[y]) {\r\n                    incompleteRows[y] = true;\r\n                    continue rows;\r\n                }\r\n            }\r\n        }\r\n\r\n        const result: number[] = [];\r\n        for (let row = 0; row < rowCount; row++) {\r\n            if (!incompleteRows[row]) result.push(row);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private deleteRow(row: number): void {\r\n        this._blocks.forEach(col => {\r\n            col.splice(row, 1);\r\n            col.unshift(undefined);\r\n        });\r\n    }\r\n\r\n    public clear(): void {\r\n        this._blocks = [];\r\n        for (let x = 0; x < this.size.width; x++) {\r\n            this._blocks[x] = new Array(this.size.height);\r\n        }\r\n    }\r\n\r\n    public contains(matrix: IPositionedMatrix): boolean {\r\n        return matrixContains(this._blocks, matrix);\r\n    }\r\n\r\n    public collides(matrix: IPositionedMatrix): boolean {\r\n        return !this.contains(matrix)\r\n            || matrixesColliding(this.blocks, matrix);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/board.ts","export default class Timer {\r\n    private _handle: number | void;\r\n    private readonly _handler: () => void;\r\n    private readonly _interval: number;\r\n    private readonly _repeat: boolean;\r\n    private _running = false;\r\n\r\n    public get running() { return this._running; }\r\n\r\n    constructor(handler: () => void, interval: number, repeat = true) {\r\n        this._handler = handler;\r\n        this._interval = interval;\r\n        this._repeat = repeat;\r\n    }\r\n\r\n    public start(executeOnInit = false): void {\r\n        if (executeOnInit) {\r\n            this._handler();\r\n            if (!this._repeat) return;\r\n        }\r\n\r\n        this.stop();\r\n\r\n        this._handle = (\r\n            this._repeat\r\n                ? setInterval\r\n                : setTimeout\r\n        )(() => {\r\n            this._handler();\r\n            this._running = false;\r\n        }, this._interval);\r\n        this._running = true;\r\n    }\r\n\r\n    public stop(): void {\r\n        this._handle = (\r\n            this._repeat\r\n                ? clearInterval\r\n                : clearTimeout\r\n        )(this._handle as number);\r\n        this._running = false;\r\n    }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/timer.ts","export default class UniqueArray<T> {\r\n    private _array: T[] = [];\r\n\r\n    public get count() { return this._array.length; }\r\n    public get values() { return this._array; }\r\n\r\n    public add(value: T): void {\r\n        if (!this.contains(value)) {\r\n            this._array.push(value);\r\n        }\r\n    }\r\n\r\n    public remove(value: T): void {\r\n        const index = this._array.indexOf(value);\r\n        if (index >= 0) {\r\n            this._array.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    public contains(value: T): boolean {\r\n        return this._array.indexOf(value) >= 0;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/unique-array.ts","import Matrix from '../interfaces/matrix';\r\nimport { rotateMatrix } from '../services/matrix-calculations';\r\n\r\nexport default class Shape {\r\n    private _blocks: Matrix;\r\n    public get blocks() {\r\n        return this._blocks;\r\n    }\r\n\r\n    constructor(blocks: Matrix) {\r\n        this._blocks = blocks;\r\n    }\r\n\r\n    public rotate(reverse = false): void {\r\n        this._blocks = rotateMatrix(this._blocks, reverse);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shape.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Blue;\r\n\r\nexport default class I extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/i.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Pink;\r\n\r\nexport default class J extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0],\r\n            [0, c, 0],\r\n            [c, c, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/j.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Orange;\r\n\r\nexport default class L extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0],\r\n            [0, c, 0],\r\n            [0, c, c]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/l.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Yellow;\r\n\r\nexport default class O extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c],\r\n            [c, c]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/o.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Red;\r\n\r\nexport default class S extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, c],\r\n            [c, c, 0],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/s.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Purple;\r\n\r\nexport default class T extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c, c],\r\n            [0, c, 0],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/t.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Green;\r\n\r\nexport default class Z extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c, 0],\r\n            [0, c, c],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/z.ts","import IPoint, { clonePoint } from '../interfaces/point';\r\nimport { resetControls } from '../services/key-handling';\r\nimport getRandomShape from '../services/random-shape';\r\nimport Shape from './shape';\r\n\r\nexport default class Player {\r\n    private _shape: Shape;\r\n    public get shape() {\r\n        return this._shape;\r\n    }\r\n\r\n    public position: IPoint;\r\n    private _startingPos: IPoint;\r\n\r\n    public softDropPoints = 0;\r\n\r\n    constructor(startingPosition: IPoint) {\r\n        this._startingPos = startingPosition;\r\n        this.reset();\r\n    }\r\n\r\n    public reset(): void {\r\n        this.position = clonePoint(this._startingPos);\r\n        this._shape = getRandomShape();\r\n        resetControls();\r\n        this.softDropPoints = 0;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/player.ts","import Panel from '../components/panel';\r\nimport Board from '../models/board';\r\nimport Player from '../models/player';\r\n\r\nconst boardSize = {\r\n    width: 10,\r\n    height: 20\r\n};\r\n\r\nexport const player = new Player({ x: boardSize.width / 2 - 1, y: 0 });\r\nexport const panel = new Panel('game');\r\nexport const board = new Board(boardSize);\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/storage.ts","import loadPlayerScore from './components/player-score';\r\nimport { setLoopSpeed } from './services/gameloop';\r\nimport handleKeys from './services/key-handling';\r\nimport settings from './settings';\r\nimport './vendor/modernizr.min.js';\r\n\r\nsetLoopSpeed(settings.gameSpeed);\r\nhandleKeys();\r\nloadPlayerScore();\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/index.ts","/*! modernizr 3.5.0 (Custom Build) | MIT *\r\n * https://modernizr.com/download/?-canvas-localstorage-serviceworker-sessionstorage-touchevents-webgl !*/\r\n!function(e,t,n){function o(e,t){return typeof e===t}function r(){var e,t,n,r,s,a,i;for(var d in l)if(l.hasOwnProperty(d)){if(e=[],t=l[d],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(r=o(t.fn,\"function\")?t.fn():t.fn,s=0;s<e.length;s++)a=e[s],i=a.split(\".\"),1===i.length?Modernizr[i[0]]=r:(!Modernizr[i[0]]||Modernizr[i[0]]instanceof Boolean||(Modernizr[i[0]]=new Boolean(Modernizr[i[0]])),Modernizr[i[0]][i[1]]=r),c.push((r?\"\":\"no-\")+i.join(\"-\"))}}function s(){return\"function\"!=typeof t.createElement?t.createElement(arguments[0]):u?t.createElementNS.call(t,\"http://www.w3.org/2000/svg\",arguments[0]):t.createElement.apply(t,arguments)}function a(){var e=t.body;return e||(e=s(u?\"svg\":\"body\"),e.fake=!0),e}function i(e,n,o,r){var i,l,d,c,u=\"modernizr\",p=s(\"div\"),v=a();if(parseInt(o,10))for(;o--;)d=s(\"div\"),d.id=r?r[o]:u+(o+1),p.appendChild(d);return i=s(\"style\"),i.type=\"text/css\",i.id=\"s\"+u,(v.fake?v:p).appendChild(i),v.appendChild(p),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),p.id=u,v.fake&&(v.style.background=\"\",v.style.overflow=\"hidden\",c=f.style.overflow,f.style.overflow=\"hidden\",f.appendChild(v)),l=n(p,e),v.fake?(v.parentNode.removeChild(v),f.style.overflow=c,f.offsetHeight):p.parentNode.removeChild(p),!!l}var l=[],d={_version:\"3.5.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){l.push({name:e,fn:t,options:n})},addAsyncTest:function(e){l.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=d,Modernizr=new Modernizr,Modernizr.addTest(\"serviceworker\",\"serviceWorker\"in navigator),Modernizr.addTest(\"localstorage\",function(){var e=\"modernizr\";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}),Modernizr.addTest(\"sessionstorage\",function(){var e=\"modernizr\";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}});var c=[],f=t.documentElement,u=\"svg\"===f.nodeName.toLowerCase();Modernizr.addTest(\"canvas\",function(){var e=s(\"canvas\");return!(!e.getContext||!e.getContext(\"2d\"))}),Modernizr.addTest(\"webgl\",function(){var t=s(\"canvas\"),n=\"probablySupportsContext\"in t?\"probablySupportsContext\":\"supportsContext\";return n in t?t[n](\"webgl\")||t[n](\"experimental-webgl\"):\"WebGLRenderingContext\"in e});var p=d._config.usePrefixes?\" -webkit- -moz- -o- -ms- \".split(\" \"):[\"\",\"\"];d._prefixes=p;var v=d.testStyles=i;Modernizr.addTest(\"touchevents\",function(){var n;if(\"ontouchstart\"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var o=[\"@media (\",p.join(\"touch-enabled),(\"),\"heartz\",\")\",\"{#modernizr{top:9px;position:absolute}}\"].join(\"\");v(o,function(e){n=9===e.offsetTop})}return n}),r(),delete d.addTest,delete d.addAsyncTest;for(var m=0;m<Modernizr._q.length;m++)Modernizr._q[m]();e.Modernizr=Modernizr}(window,document);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/vendor/modernizr.min.js\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}