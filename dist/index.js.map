{"version":3,"sources":["webpack:///index.js","webpack:///webpack/bootstrap 8e79afc500a14114dfe6","webpack:///./src/services/player-score.ts","webpack:///./src/services/draw-grid.ts","webpack:///./src/services/draw-matrix.ts","webpack:///./src/services/matrix-calculations.ts","webpack:///./src/interfaces/point.ts","webpack:///./src/services/arrays.ts","webpack:///./src/services/random-shape.ts","webpack:///./src/services/game-over.ts","webpack:///./src/services/gameloop.ts","webpack:///./src/components/player-score.ts","webpack:///./src/settings.ts","webpack:///./src/components/panel.ts","webpack:///./src/models/board.ts","webpack:///./src/models/shape.ts","webpack:///./src/models/shapes/i.ts","webpack:///./src/models/shapes/j.ts","webpack:///./src/models/shapes/l.ts","webpack:///./src/models/shapes/o.ts","webpack:///./src/models/shapes/s.ts","webpack:///./src/models/shapes/t.ts","webpack:///./src/models/shapes/z.ts","webpack:///./src/models/player.ts","webpack:///./src/services/storage.ts","webpack:///./src/services/key-handling.ts","webpack:///./src/index.ts","webpack:///./src/vendor/modernizr.min.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","addScore","points","currentScore","triggerScoreChange","resetScore","onScoreChange","handler","triggerOnInit","subscribers","push","forEach","drawGrid","panel","gridSize","tileSize","width","size","height","ctx","strokeStyle","lineWidth","pixelRatio","x","beginPath","moveTo","lineTo","stroke","y","drawMatrix","matrix","length","col","item","src_settings","drawEmptyTiles","fillStyle","getColorCode","fillRect","color","createMatrix","result","Array","copyMatrix","reduce","slice","getMatrixSize","mergeMatrixes","m1","m2","position","target","j","value","addMatrix","source","xyMatrix","rotateMatrix","reverse","matrixContains","parent","child","matrixesColliding","clonePoint","point","pointEquals","a","b","findIndex","array","predicate","findAny","getRandomShape","Shape","shapes","Math","floor","random","gameOver","storage_board","clear","storage_player","reset","update","newPos","collides","shape","blocks","place","linesCleared","clearFullLines","softDropPoints","viewMatrix","storage_panel","draw","setLoopSpeed","seconds","currentSeconds","window","clearInterval","interval","setInterval","activateLoop","scoreEl","settings","gameSpeed","1","2","3","4","softDrop","hardDrop","softDropMax","hardDropMax","panel_Panel","Panel","id","canvas","document","getElementById","this","devicePixelRatio","parseInt","getAttribute","offsetWidth","setAttribute","offsetHeight","getContext","Error","clearRect","components_panel","board_Board","Board","_blocks","_this","fullRows","getFullLines","row","deleteRow","rowCount","incompleteRows","rows","splice","unshift","undefined","contains","models_board","shape_Shape","rotate","models_shape","__extends","extendStatics","setPrototypeOf","__proto__","__","constructor","create","i_I","_super","I","j___extends","j_c","j_J","J","l___extends","l_c","l_L","L","o___extends","o_c","o_O","O","s___extends","s_c","s_S","S","t___extends","t_c","t_T","T","t","z___extends","z_c","z_Z","Z","z","player_Player","Player","startingPosition","_startingPos","_shape","getContainedPosition","board","xLow","xHigh","player","handleKeys","addEventListener","e","newPosition","triggered","code","repeat","sdPoints","nextPos","hdPoints","min","preventDefault","key_handling","score","textContent","toLocaleString","createElement","arguments","u","createElementNS","apply","body","fake","r","v","appendChild","type","styleSheet","cssText","createTextNode","style","background","overflow","f","parentNode","removeChild","_version","_config","classPrefix","enableClasses","enableJSClass","usePrefixes","_q","on","setTimeout","addTest","fn","options","addAsyncTest","Modernizr","navigator","localStorage","setItem","removeItem","sessionStorage","documentElement","nodeName","toLowerCase","split","_prefixes","testStyles","DocumentTouch","join","offsetTop","aliases","Boolean"],"mappings":"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","file":"index.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// CONCATENATED MODULE: ./src/services/player-score.ts\nvar currentScore = 0;\r\nfunction addScore(points) {\r\n    currentScore += points;\r\n    triggerScoreChange();\r\n}\r\nfunction resetScore() {\r\n    currentScore = 0;\r\n    triggerScoreChange();\r\n}\r\nvar subscribers = [];\r\nfunction onScoreChange(handler, triggerOnInit) {\r\n    if (triggerOnInit === void 0) { triggerOnInit = false; }\r\n    subscribers.push(handler);\r\n    if (triggerOnInit)\r\n        handler(currentScore);\r\n}\r\nfunction triggerScoreChange() {\r\n    subscribers.forEach(function (handler) { return handler(currentScore); });\r\n}\r\n\n// CONCATENATED MODULE: ./src/components/player-score.ts\n\r\nvar scoreEl;\r\nfunction loadPlayerScore() {\r\n    scoreEl = document.getElementById('player-score');\r\n    onScoreChange(function (score) {\r\n        scoreEl.textContent = score.toLocaleString();\r\n    }, true);\r\n}\r\n\n// CONCATENATED MODULE: ./src/settings.ts\nvar settings = {\r\n    gameSpeed: 0.4,\r\n    points: {\r\n        linesCleared: {\r\n            1: 40,\r\n            2: 100,\r\n            3: 300,\r\n            4: 1200\r\n        },\r\n        softDrop: 1,\r\n        hardDrop: 2,\r\n        softDropMax: 20,\r\n        hardDropMax: 40\r\n    },\r\n    drawEmptyTiles: false\r\n};\r\n/* harmony default export */ var src_settings = (settings);\r\n\n// CONCATENATED MODULE: ./src/services/draw-grid.ts\nfunction drawGrid(panel, gridSize) {\r\n    var tileSize = {\r\n        width: panel.size.width / gridSize.width,\r\n        height: panel.size.height / gridSize.height\r\n    };\r\n    var ctx = panel.ctx;\r\n    ctx.strokeStyle = '#efefef';\r\n    ctx.lineWidth = panel.pixelRatio;\r\n    for (var x = 0; x < panel.size.width; x += tileSize.width) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, 0);\r\n        ctx.lineTo(x, panel.size.height);\r\n        ctx.stroke();\r\n    }\r\n    for (var y = 0; y < panel.size.height; y += tileSize.height) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, y);\r\n        ctx.lineTo(panel.size.width, y);\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/draw-matrix.ts\n\r\nfunction drawMatrix(panel, matrix) {\r\n    var ctx = panel.ctx;\r\n    var tileSize = {\r\n        width: panel.size.width / matrix.length,\r\n        height: panel.size.height / matrix[0].length\r\n    };\r\n    matrix.forEach(function (col, x) { return col.forEach(function (item, y) {\r\n        if (typeof item === 'undefined' ||\r\n            !src_settings.drawEmptyTiles && !item)\r\n            return;\r\n        ctx.fillStyle = item ? getColorCode(item) : '#8ED6FF';\r\n        ctx.fillRect(x * tileSize.width, y * tileSize.height, tileSize.width, tileSize.height);\r\n    }); });\r\n}\r\nfunction getColorCode(color) {\r\n    switch (color) {\r\n        case 1:\r\n            return '#ffeb3b';\r\n        case 2:\r\n            return '#03a9f4';\r\n        case 3:\r\n            return '#f44336';\r\n        case 4:\r\n            return '#4caf50';\r\n        case 5:\r\n            return '#ff9800';\r\n        case 6:\r\n            return '#fbafbc';\r\n        case 7:\r\n            return '#9c27b0';\r\n        default:\r\n            return '#000';\r\n    }\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/matrix-calculations.ts\nfunction createMatrix(size) {\r\n    var result = [];\r\n    for (var col = 0; col < size.width; col++) {\r\n        result[col] = new Array(size.height);\r\n    }\r\n    return result;\r\n}\r\nfunction copyMatrix(matrix) {\r\n    return matrix.reduce(function (result, col, x) {\r\n        result[x] = col.slice();\r\n        return result;\r\n    }, []);\r\n}\r\nfunction getMatrixSize(matrix) {\r\n    return {\r\n        width: matrix.length,\r\n        height: matrix[0].length\r\n    };\r\n}\r\nfunction mergeMatrixes(m1, m2, position, target) {\r\n    var result = target || copyMatrix(m1);\r\n    for (var i = 0; i < m2.length; i++) {\r\n        for (var j = 0; j < m2[0].length; j++) {\r\n            var value = m2[i][j];\r\n            if (typeof value === 'undefined')\r\n                continue;\r\n            var x = i + position.x;\r\n            var y = j + position.y;\r\n            if (x >= 0 && x < m1.length &&\r\n                y >= 0 && y < m1[0].length &&\r\n                (value || !result[x][y])) {\r\n                result[x][y] = value;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction addMatrix(target, source, position) {\r\n    mergeMatrixes(target, source, position, target);\r\n}\r\nfunction xyMatrix(matrix) {\r\n    return rotateMatrix(matrix)\r\n        .reduce(function (result, col, x) {\r\n        result[x] = col.reverse();\r\n        return result;\r\n    }, []);\r\n}\r\nfunction rotateMatrix(matrix, reverse) {\r\n    if (reverse === void 0) { reverse = false; }\r\n    var l = matrix.length;\r\n    var result = createMatrix({ width: l, height: l });\r\n    for (var x = 0; x < l; x++) {\r\n        for (var y = 0; y < l; y++) {\r\n            result[x][y] = reverse\r\n                ? matrix[l - y - 1][x]\r\n                : matrix[y][l - x - 1];\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction matrixContains(parent, child, position) {\r\n    for (var i = 0; i < child.length; i++) {\r\n        var col = child[i];\r\n        for (var j = 0; j < col.length; j++) {\r\n            if (!col[j])\r\n                continue;\r\n            var x = i + position.x;\r\n            var y = j + position.y;\r\n            if (x < 0 || x >= parent.length ||\r\n                y < 0 || y >= parent[0].length) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction matrixesColliding(m1, m2, position) {\r\n    for (var x = 0; x < m2.length; x++) {\r\n        for (var y = 0; y < m2[0].length; y++) {\r\n            if (!m2[x][y])\r\n                continue;\r\n            if (m1[x + position.x][y + position.y]) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\n// CONCATENATED MODULE: ./src/components/panel.ts\n\r\n\r\n\r\nvar panel_Panel = (function () {\r\n    function Panel(id) {\r\n        var canvas = document.getElementById(id);\r\n        this.pixelRatio = devicePixelRatio || 1;\r\n        this.size = {\r\n            width: parseInt(canvas.getAttribute('width'), 10) * this.pixelRatio,\r\n            height: parseInt(canvas.getAttribute('height'), 10) * this.pixelRatio\r\n        };\r\n        if (this.size.width !== canvas.offsetWidth) {\r\n            canvas.setAttribute('width', \"\" + this.size.width);\r\n        }\r\n        if (this.size.height !== canvas.offsetHeight) {\r\n            canvas.setAttribute('height', \"\" + this.size.height);\r\n        }\r\n        var ctx = canvas.getContext('2d');\r\n        if (!ctx)\r\n            throw new Error('Context not found!');\r\n        this.ctx = ctx;\r\n    }\r\n    Panel.prototype.draw = function (matrix) {\r\n        this.clear();\r\n        drawGrid(this, getMatrixSize(matrix));\r\n        drawMatrix(this, matrix);\r\n    };\r\n    Panel.prototype.clear = function () {\r\n        this.ctx.clearRect(0, 0, this.size.width, this.size.height);\r\n    };\r\n    return Panel;\r\n}());\r\n/* harmony default export */ var components_panel = (panel_Panel);\r\n\n// CONCATENATED MODULE: ./src/models/board.ts\n\r\nvar board_Board = (function () {\r\n    function Board(size) {\r\n        this.size = size;\r\n        this.clear();\r\n    }\r\n    Object.defineProperty(Board.prototype, \"blocks\", {\r\n        get: function () { return this._blocks; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Board.prototype.place = function (shape, position) {\r\n        addMatrix(this.blocks, shape.blocks, position);\r\n    };\r\n    Board.prototype.clearFullLines = function () {\r\n        var _this = this;\r\n        var fullRows = this.getFullLines();\r\n        fullRows.forEach(function (row) { return _this.deleteRow(row); });\r\n        return fullRows.length;\r\n    };\r\n    Board.prototype.getFullLines = function () {\r\n        var rowCount = this._blocks[0].length;\r\n        var incompleteRows = new Array(rowCount - 1);\r\n        rows: for (var y = 0; y < rowCount; y++) {\r\n            for (var x = 0; x < this._blocks.length; x++) {\r\n                if (!this._blocks[x][y]) {\r\n                    incompleteRows[y] = true;\r\n                    continue rows;\r\n                }\r\n            }\r\n        }\r\n        var result = [];\r\n        for (var row = 0; row < rowCount; row++) {\r\n            if (!incompleteRows[row])\r\n                result.push(row);\r\n        }\r\n        return result;\r\n    };\r\n    Board.prototype.deleteRow = function (row) {\r\n        this._blocks.forEach(function (col) {\r\n            col.splice(row, 1);\r\n            col.unshift(undefined);\r\n        });\r\n    };\r\n    Board.prototype.clear = function () {\r\n        this._blocks = [];\r\n        for (var x = 0; x < this.size.width; x++) {\r\n            this._blocks[x] = new Array(this.size.height);\r\n        }\r\n    };\r\n    Board.prototype.contains = function (matrix, position) {\r\n        return matrixContains(this._blocks, matrix, position);\r\n    };\r\n    Board.prototype.collides = function (matrix, position) {\r\n        return !this.contains(matrix, position)\r\n            || matrixesColliding(this.blocks, matrix, position);\r\n    };\r\n    return Board;\r\n}());\r\n/* harmony default export */ var models_board = (board_Board);\r\n\n// CONCATENATED MODULE: ./src/interfaces/point.ts\nfunction clonePoint(point) {\r\n    return { x: point.x, y: point.y };\r\n}\r\nfunction pointEquals(a, b) {\r\n    return a.x === b.x && a.y === b.y;\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/arrays.ts\nfunction findIndex(array, predicate) {\r\n    for (var i = 0; i < array.length; i++) {\r\n        var value = array[i];\r\n        if (predicate(value, i)) {\r\n            return i;\r\n        }\r\n    }\r\n}\r\nfunction findAny(array, predicate) {\r\n    return typeof findIndex(array, predicate) !== 'undefined';\r\n}\r\n\n// CONCATENATED MODULE: ./src/models/shape.ts\n\r\nvar shape_Shape = (function () {\r\n    function Shape(blocks) {\r\n        this._blocks = blocks;\r\n    }\r\n    Object.defineProperty(Shape.prototype, \"blocks\", {\r\n        get: function () {\r\n            return this._blocks;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Shape.prototype.rotate = function (reverse) {\r\n        if (reverse === void 0) { reverse = false; }\r\n        this._blocks = rotateMatrix(this._blocks, reverse);\r\n    };\r\n    return Shape;\r\n}());\r\n/* harmony default export */ var models_shape = (shape_Shape);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/i.ts\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar c = 2;\r\nvar i_I = (function (_super) {\r\n    __extends(I, _super);\r\n    function I() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return I;\r\n}(models_shape));\r\n/* harmony default export */ var i = (i_I);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/j.ts\nvar j___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar j_c = 6;\r\nvar j_J = (function (_super) {\r\n    j___extends(J, _super);\r\n    function J() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, j_c, 0],\r\n            [0, j_c, 0],\r\n            [j_c, j_c, 0]\r\n        ])) || this;\r\n    }\r\n    return J;\r\n}(models_shape));\r\n/* harmony default export */ var j = (j_J);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/l.ts\nvar l___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar l_c = 5;\r\nvar l_L = (function (_super) {\r\n    l___extends(L, _super);\r\n    function L() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, l_c, 0],\r\n            [0, l_c, 0],\r\n            [0, l_c, l_c]\r\n        ])) || this;\r\n    }\r\n    return L;\r\n}(models_shape));\r\n/* harmony default export */ var l = (l_L);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/o.ts\nvar o___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar o_c = 1;\r\nvar o_O = (function (_super) {\r\n    o___extends(O, _super);\r\n    function O() {\r\n        return _super.call(this, xyMatrix([\r\n            [o_c, o_c],\r\n            [o_c, o_c]\r\n        ])) || this;\r\n    }\r\n    return O;\r\n}(models_shape));\r\n/* harmony default export */ var o = (o_O);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/s.ts\nvar s___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar s_c = 3;\r\nvar s_S = (function (_super) {\r\n    s___extends(S, _super);\r\n    function S() {\r\n        return _super.call(this, xyMatrix([\r\n            [0, s_c, s_c],\r\n            [s_c, s_c, 0],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return S;\r\n}(models_shape));\r\n/* harmony default export */ var s = (s_S);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/t.ts\nvar t___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar t_c = 7;\r\nvar t_T = (function (_super) {\r\n    t___extends(T, _super);\r\n    function T() {\r\n        return _super.call(this, xyMatrix([\r\n            [t_c, t_c, t_c],\r\n            [0, t_c, 0],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return T;\r\n}(models_shape));\r\n/* harmony default export */ var t = (t_T);\r\n\n// CONCATENATED MODULE: ./src/models/shapes/z.ts\nvar z___extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar z_c = 4;\r\nvar z_Z = (function (_super) {\r\n    z___extends(Z, _super);\r\n    function Z() {\r\n        return _super.call(this, xyMatrix([\r\n            [z_c, z_c, 0],\r\n            [0, z_c, z_c],\r\n            [0, 0, 0]\r\n        ])) || this;\r\n    }\r\n    return Z;\r\n}(models_shape));\r\n/* harmony default export */ var z = (z_Z);\r\n\n// CONCATENATED MODULE: ./src/services/random-shape.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar shapes = [i, j, l, o, s, t, z];\r\nfunction getRandomShape() {\r\n    var Shape = shapes[Math.floor(Math.random() * shapes.length)];\r\n    return new Shape();\r\n}\r\n\n// CONCATENATED MODULE: ./src/models/player.ts\n\r\n\r\n\r\nvar player_Player = (function () {\r\n    function Player(startingPosition) {\r\n        this.softDropPoints = 0;\r\n        this._startingPos = startingPosition;\r\n        this.reset();\r\n    }\r\n    Object.defineProperty(Player.prototype, \"shape\", {\r\n        get: function () {\r\n            return this._shape;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Player.prototype.reset = function () {\r\n        this.position = clonePoint(this._startingPos);\r\n        this._shape = getRandomShape();\r\n    };\r\n    Player.prototype.getContainedPosition = function (board) {\r\n        var position = clonePoint(this.position);\r\n        var xLow = findIndex(this._shape.blocks, function (col) {\r\n            return findAny(col, function (value) { return !!value; });\r\n        }) + position.x;\r\n        if (xLow < 0) {\r\n            position.x += 0 - xLow;\r\n            return position;\r\n        }\r\n        var xHigh = this._shape.blocks.length -\r\n            findIndex(this._shape.blocks.reverse(), function (col) {\r\n                return findAny(col, function (value) { return !!value; });\r\n            }) + position.x;\r\n        if (xHigh > board.blocks.length) {\r\n            position.x -= xHigh - board.blocks.length;\r\n            return position;\r\n        }\r\n        return position;\r\n    };\r\n    return Player;\r\n}());\r\n/* harmony default export */ var player = (player_Player);\r\n\n// CONCATENATED MODULE: ./src/services/storage.ts\n\r\n\r\n\r\nvar storage_player = new player({ x: 7, y: 0 });\r\nvar storage_panel = new components_panel('game');\r\nvar storage_board = new models_board({\r\n    width: 16,\r\n    height: 24\r\n});\r\n\n// CONCATENATED MODULE: ./src/services/game-over.ts\n\r\n\r\nfunction gameOver() {\r\n    storage_board.clear();\r\n    storage_player.reset();\r\n    resetScore();\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/gameloop.ts\n\r\n\r\n\r\n\r\n\r\nfunction update() {\r\n    var newPos = {\r\n        x: storage_player.position.x,\r\n        y: storage_player.position.y + 1\r\n    };\r\n    if (!storage_board.collides(storage_player.shape.blocks, newPos)) {\r\n        storage_player.position = newPos;\r\n    }\r\n    else {\r\n        storage_board.place(storage_player.shape, storage_player.position);\r\n        var linesCleared = storage_board.clearFullLines();\r\n        if (linesCleared) {\r\n            var scoring = src_settings.points.linesCleared;\r\n            addScore(scoring[linesCleared]);\r\n        }\r\n        storage_player.reset();\r\n        storage_player.softDropPoints = 0;\r\n        if (storage_board.collides(storage_player.shape.blocks, storage_player.position)) {\r\n            gameOver();\r\n        }\r\n    }\r\n    var viewMatrix = mergeMatrixes(storage_board.blocks, storage_player.shape.blocks, storage_player.position);\r\n    storage_panel.draw(viewMatrix);\r\n}\r\nvar interval;\r\nvar currentSeconds;\r\nfunction setLoopSpeed(seconds) {\r\n    currentSeconds = seconds;\r\n    window.clearInterval(interval);\r\n    update();\r\n    interval = window.setInterval(update, seconds * 1000);\r\n}\r\nfunction activateLoop() {\r\n    setLoopSpeed(currentSeconds);\r\n}\r\n\n// CONCATENATED MODULE: ./src/services/key-handling.ts\n\r\n\r\n\r\n\r\n\r\n\r\nvar handleKeys = function () { return document.addEventListener('keydown', function (e) {\r\n    var newPosition = {\r\n        x: storage_player.position.x,\r\n        y: storage_player.position.y\r\n    };\r\n    var triggered = true;\r\n    switch (e.code) {\r\n        case 'ArrowUp':\r\n            if (e.repeat)\r\n                return;\r\n            storage_player.shape.rotate();\r\n            if (!storage_board.contains(storage_player.shape.blocks, newPosition)) {\r\n                newPosition = storage_player.getContainedPosition(storage_board);\r\n            }\r\n            break;\r\n        case 'ArrowRight':\r\n            newPosition.x++;\r\n            break;\r\n        case 'ArrowDown':\r\n            newPosition.y++;\r\n            var sdPoints = src_settings.points.softDrop;\r\n            storage_player.softDropPoints += sdPoints;\r\n            if (storage_player.softDropPoints < src_settings.points.softDropMax) {\r\n                addScore(sdPoints);\r\n            }\r\n            break;\r\n        case 'ArrowLeft':\r\n            newPosition.x--;\r\n            break;\r\n        case 'Space':\r\n            var nextPos = newPosition;\r\n            var hdPoints = 0;\r\n            do {\r\n                nextPos = { x: nextPos.x, y: nextPos.y + 1 };\r\n                hdPoints += src_settings.points.hardDrop;\r\n            } while (!storage_board.collides(storage_player.shape.blocks, nextPos));\r\n            newPosition = { x: nextPos.x, y: nextPos.y - 1 };\r\n            addScore(Math.min(hdPoints - src_settings.points.hardDrop, src_settings.points.hardDropMax));\r\n            break;\r\n        default:\r\n            triggered = false;\r\n            break;\r\n    }\r\n    var posChanged = !pointEquals(storage_player.position, newPosition);\r\n    if (posChanged) {\r\n        if (!storage_board.collides(storage_player.shape.blocks, newPosition)) {\r\n            storage_player.position = newPosition;\r\n        }\r\n        else\r\n            activateLoop();\r\n    }\r\n    if (triggered) {\r\n        e.preventDefault();\r\n        var viewMatrix = mergeMatrixes(storage_board.blocks, storage_player.shape.blocks, storage_player.position);\r\n        storage_panel.draw(viewMatrix);\r\n    }\r\n}); };\r\n/* harmony default export */ var key_handling = (handleKeys);\r\n\n// EXTERNAL MODULE: ./src/vendor/modernizr.min.js\nvar modernizr_min = __webpack_require__(1);\nvar modernizr_min_default = /*#__PURE__*/__webpack_require__.n(modernizr_min);\n\n// CONCATENATED MODULE: ./src/index.ts\n\r\n\r\n\r\n\r\n\r\nsetLoopSpeed(src_settings.gameSpeed);\r\nkey_handling();\r\nloadPlayerScore();\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n/*! modernizr 3.5.0 (Custom Build) | MIT *\r\n * https://modernizr.com/download/?-canvas-localstorage-serviceworker-sessionstorage-touchevents-webgl !*/\r\n!function(e,t,n){function o(e,t){return typeof e===t}function r(){var e,t,n,r,s,a,i;for(var d in l)if(l.hasOwnProperty(d)){if(e=[],t=l[d],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(r=o(t.fn,\"function\")?t.fn():t.fn,s=0;s<e.length;s++)a=e[s],i=a.split(\".\"),1===i.length?Modernizr[i[0]]=r:(!Modernizr[i[0]]||Modernizr[i[0]]instanceof Boolean||(Modernizr[i[0]]=new Boolean(Modernizr[i[0]])),Modernizr[i[0]][i[1]]=r),c.push((r?\"\":\"no-\")+i.join(\"-\"))}}function s(){return\"function\"!=typeof t.createElement?t.createElement(arguments[0]):u?t.createElementNS.call(t,\"http://www.w3.org/2000/svg\",arguments[0]):t.createElement.apply(t,arguments)}function a(){var e=t.body;return e||(e=s(u?\"svg\":\"body\"),e.fake=!0),e}function i(e,n,o,r){var i,l,d,c,u=\"modernizr\",p=s(\"div\"),v=a();if(parseInt(o,10))for(;o--;)d=s(\"div\"),d.id=r?r[o]:u+(o+1),p.appendChild(d);return i=s(\"style\"),i.type=\"text/css\",i.id=\"s\"+u,(v.fake?v:p).appendChild(i),v.appendChild(p),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),p.id=u,v.fake&&(v.style.background=\"\",v.style.overflow=\"hidden\",c=f.style.overflow,f.style.overflow=\"hidden\",f.appendChild(v)),l=n(p,e),v.fake?(v.parentNode.removeChild(v),f.style.overflow=c,f.offsetHeight):p.parentNode.removeChild(p),!!l}var l=[],d={_version:\"3.5.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){l.push({name:e,fn:t,options:n})},addAsyncTest:function(e){l.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=d,Modernizr=new Modernizr,Modernizr.addTest(\"serviceworker\",\"serviceWorker\"in navigator),Modernizr.addTest(\"localstorage\",function(){var e=\"modernizr\";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}),Modernizr.addTest(\"sessionstorage\",function(){var e=\"modernizr\";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}});var c=[],f=t.documentElement,u=\"svg\"===f.nodeName.toLowerCase();Modernizr.addTest(\"canvas\",function(){var e=s(\"canvas\");return!(!e.getContext||!e.getContext(\"2d\"))}),Modernizr.addTest(\"webgl\",function(){var t=s(\"canvas\"),n=\"probablySupportsContext\"in t?\"probablySupportsContext\":\"supportsContext\";return n in t?t[n](\"webgl\")||t[n](\"experimental-webgl\"):\"WebGLRenderingContext\"in e});var p=d._config.usePrefixes?\" -webkit- -moz- -o- -ms- \".split(\" \"):[\"\",\"\"];d._prefixes=p;var v=d.testStyles=i;Modernizr.addTest(\"touchevents\",function(){var n;if(\"ontouchstart\"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var o=[\"@media (\",p.join(\"touch-enabled),(\"),\"heartz\",\")\",\"{#modernizr{top:9px;position:absolute}}\"].join(\"\");v(o,function(e){n=9===e.offsetTop})}return n}),r(),delete d.addTest,delete d.addAsyncTest;for(var m=0;m<Modernizr._q.length;m++)Modernizr._q[m]();e.Modernizr=Modernizr}(window,document);\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8e79afc500a14114dfe6","let currentScore = 0;\r\n\r\nexport function addScore(points: number): void {\r\n    currentScore += points;\r\n    triggerScoreChange();\r\n}\r\n\r\nexport function resetScore(): void {\r\n    currentScore = 0;\r\n    triggerScoreChange();\r\n}\r\n\r\nconst subscribers: Array<(score: number) => void> = [];\r\nexport function onScoreChange(handler: (score: number) => void, triggerOnInit = false): void {\r\n    subscribers.push(handler);\r\n    if (triggerOnInit) handler(currentScore);\r\n}\r\n\r\nfunction triggerScoreChange(): void {\r\n    subscribers.forEach(handler => handler(currentScore));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/player-score.ts","import Panel from '../components/panel';\r\nimport { ISize } from '../interfaces/size';\r\n\r\nexport default function drawGrid(panel: Panel, gridSize: ISize): void {\r\n    const tileSize: ISize = {\r\n        width: panel.size.width / gridSize.width,\r\n        height: panel.size.height / gridSize.height\r\n    };\r\n\r\n    const { ctx } = panel;\r\n    ctx.strokeStyle = '#efefef';\r\n    ctx.lineWidth = panel.pixelRatio;\r\n\r\n    for (let x = 0; x < panel.size.width; x += tileSize.width) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, 0);\r\n        ctx.lineTo(x, panel.size.height);\r\n        ctx.stroke();\r\n    }\r\n\r\n    for (let y = 0; y < panel.size.height; y += tileSize.height) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, y);\r\n        ctx.lineTo(panel.size.width, y);\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/draw-grid.ts","import Panel from '../components/panel';\r\nimport Matrix from '../interfaces/matrix';\r\nimport { ISize } from '../interfaces/size';\r\nimport { Color } from '../models/color';\r\nimport settings from '../settings';\r\n\r\nexport default function drawMatrix(panel: Panel, matrix: Matrix): void {\r\n    const ctx = panel.ctx;\r\n\r\n    const tileSize: ISize = {\r\n        width: panel.size.width / matrix.length,\r\n        height: panel.size.height / matrix[0].length\r\n    };\r\n\r\n    matrix.forEach((col, x) => col.forEach((item, y) => {\r\n        if (typeof item === 'undefined' ||\r\n            !settings.drawEmptyTiles && !item) return;\r\n\r\n        ctx.fillStyle = item ? getColorCode(item) : '#8ED6FF';\r\n        ctx.fillRect(x * tileSize.width, y * tileSize.height,\r\n            tileSize.width, tileSize.height);\r\n    }));\r\n}\r\n\r\nfunction getColorCode(color: Color): string {\r\n    switch (color) {\r\n        case Color.Yellow:\r\n            return '#ffeb3b';\r\n        case Color.Blue:\r\n            return '#03a9f4';\r\n        case Color.Red:\r\n            return '#f44336';\r\n        case Color.Green:\r\n            return '#4caf50';\r\n        case Color.Orange:\r\n            return '#ff9800';\r\n        case Color.Pink:\r\n            return '#fbafbc';\r\n        case Color.Purple:\r\n            return '#9c27b0';\r\n        default:\r\n            return '#000';\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/draw-matrix.ts","import Matrix from '../interfaces/matrix';\r\nimport IPoint from '../interfaces/point';\r\nimport { ISize } from '../interfaces/size';\r\n\r\nexport function createMatrix(size: ISize): Matrix {\r\n    const result: Matrix = [];\r\n    for (let col = 0; col < size.width; col++) {\r\n        result[col] = new Array(size.height);\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function copyMatrix(matrix: Matrix): Matrix {\r\n    return matrix.reduce<Matrix>((result, col, x) => {\r\n        result[x] = col.slice();\r\n        return result;\r\n    }, []);\r\n}\r\n\r\nexport function getMatrixSize(matrix: Matrix): ISize {\r\n    return {\r\n        width: matrix.length,\r\n        height: matrix[0].length\r\n    };\r\n}\r\n\r\n/**\r\n * Merges m1 and m2 into a new matrix with the size of m1\r\n * @param position Position of m2 on m1\r\n */\r\nexport function mergeMatrixes(m1: Matrix, m2: Matrix, position: IPoint, target?: Matrix): Matrix {\r\n    const result = target || copyMatrix(m1);\r\n\r\n    for (let i = 0; i < m2.length; i++) {\r\n        for (let j = 0; j < m2[0].length; j++) {\r\n            const value = m2[i][j];\r\n            if (typeof value === 'undefined') continue;\r\n\r\n            const x = i + position.x;\r\n            const y = j + position.y;\r\n\r\n            if (x >= 0 && x < m1.length &&\r\n                y >= 0 && y < m1[0].length &&\r\n                (value || !result[x][y])) {\r\n                result[x][y] = value;\r\n            }\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function addMatrix(target: Matrix, source: Matrix, position: IPoint): void {\r\n    mergeMatrixes(target, source, position, target);\r\n}\r\n\r\n/**\r\n * Transforms matrix to be used in the coordinate system\r\n */\r\nexport function xyMatrix(matrix: Matrix): Matrix {\r\n    return rotateMatrix(matrix)\r\n        .reduce<Matrix>((result, col, x) => {\r\n            // Flip columns\r\n            result[x] = col.reverse();\r\n            return result;\r\n        }, []);\r\n}\r\n\r\n/**\r\n * Rotate a square 2D matrix\r\n */\r\nexport function rotateMatrix(matrix: Matrix, reverse = false): Matrix {\r\n    const l = matrix.length;\r\n    const result = createMatrix({ width: l, height: l });\r\n\r\n    // Apply rotation\r\n    for (let x = 0; x < l; x++) {\r\n        for (let y = 0; y < l; y++) {\r\n            result[x][y] = reverse\r\n                ? matrix[l - y - 1][x]\r\n                : matrix[y][l - x - 1];\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Checks if child is not outside parent matrix\r\n */\r\nexport function matrixContains(parent: Matrix, child: Matrix, position: IPoint): boolean {\r\n    for (let i = 0; i < child.length; i++) {\r\n        const col = child[i];\r\n        for (let j = 0; j < col.length; j++) {\r\n            if (!col[j]) continue;\r\n\r\n            const x = i + position.x;\r\n            const y = j + position.y;\r\n\r\n            if (x < 0 || x >= parent.length ||\r\n                y < 0 || y >= parent[0].length) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nexport function matrixesColliding(m1: Matrix, m2: Matrix, position: IPoint): boolean {\r\n    for (let x = 0; x < m2.length; x++) {\r\n        for (let y = 0; y < m2[0].length; y++) {\r\n            if (!m2[x][y]) continue;\r\n            if (m1[x + position.x][y + position.y]) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/matrix-calculations.ts","export default interface IPoint {\r\n    x: number;\r\n    y: number;\r\n}\r\n\r\nexport function clonePoint(point: IPoint): IPoint {\r\n    return { x: point.x, y: point.y };\r\n}\r\n\r\nexport function pointEquals(a: IPoint, b: IPoint): boolean {\r\n    return a.x === b.x && a.y === b.y;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/interfaces/point.ts","export function findIndex<T>(array: T[], predicate: (item: T, index: number) => boolean): number | undefined {\r\n    for (let i = 0; i < array.length; i++) {\r\n        const value = array[i];\r\n        if (predicate(value, i)) {\r\n            return i;\r\n        }\r\n    }\r\n}\r\n\r\nexport function findAny<T>(array: T[], predicate: (item: T, index: number) => boolean): boolean {\r\n    return typeof findIndex(array, predicate) !== 'undefined';\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/arrays.ts","import I from '../models/shapes/i';\r\nimport J from '../models/shapes/j';\r\nimport L from '../models/shapes/l';\r\nimport O from '../models/shapes/o';\r\nimport S from '../models/shapes/s';\r\nimport T from '../models/shapes/t';\r\nimport Z from '../models/shapes/z';\r\n\r\nconst shapes = [I, J, L, O, S, T, Z];\r\n\r\nexport default function getRandomShape() {\r\n    const Shape = shapes[Math.floor(Math.random() * shapes.length)];\r\n    return new Shape();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/random-shape.ts","import { resetScore } from './player-score';\r\nimport { board, player } from './storage';\r\n\r\nexport default function gameOver(): void {\r\n    board.clear();\r\n    player.reset();\r\n    resetScore();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/game-over.ts","import settings from '../settings';\r\nimport gameOver from './game-over';\r\nimport { mergeMatrixes } from './matrix-calculations';\r\nimport { addScore } from './player-score';\r\nimport { board, panel, player } from './storage';\r\n\r\nfunction update(): void {\r\n    const newPos = {\r\n        x: player.position.x,\r\n        y: player.position.y + 1\r\n    };\r\n\r\n    if (!board.collides(player.shape.blocks, newPos)) {\r\n        player.position = newPos;\r\n    } else {\r\n        // Colliding\r\n        board.place(player.shape, player.position);\r\n        const linesCleared = board.clearFullLines();\r\n\r\n        // Add points for cleared lines\r\n        if (linesCleared) {\r\n            const scoring = settings.points.linesCleared as { [lines: number]: number };\r\n            addScore(scoring[linesCleared]);\r\n        }\r\n\r\n        // Reset player\r\n        player.reset();\r\n        player.softDropPoints = 0;\r\n\r\n        // Detect immediate collision\r\n        if (board.collides(player.shape.blocks, player.position)) {\r\n            gameOver();\r\n        }\r\n    }\r\n\r\n    const viewMatrix = mergeMatrixes(board.blocks, player.shape.blocks, player.position);\r\n    panel.draw(viewMatrix);\r\n}\r\n\r\n// Call update immediately\r\nlet interval: number;\r\nlet currentSeconds: number;\r\nexport function setLoopSpeed(seconds: number): void {\r\n    currentSeconds = seconds;\r\n\r\n    window.clearInterval(interval);\r\n    update();\r\n    interval = window.setInterval(update, seconds * 1000);\r\n}\r\n\r\nexport function activateLoop(): void {\r\n    setLoopSpeed(currentSeconds);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/gameloop.ts","import { onScoreChange } from '../services/player-score';\r\n\r\nlet scoreEl: HTMLSpanElement;\r\n\r\nexport default function loadPlayerScore(): void {\r\n    scoreEl = document.getElementById('player-score') as HTMLSpanElement;\r\n    onScoreChange(score => {\r\n        scoreEl.textContent = score.toLocaleString();\r\n    }, true);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/components/player-score.ts","const settings = {\r\n\r\n    // Per drops per second\r\n    gameSpeed: 0.4,\r\n\r\n    points: {\r\n        // Amount of lines cleared at once\r\n        linesCleared: {\r\n            1: 40,\r\n            2: 100,\r\n            3: 300,\r\n            4: 1200\r\n        },\r\n\r\n        // Points per cell dropped\r\n        softDrop: 1,\r\n        hardDrop: 2,\r\n\r\n        // Max drop points per turn\r\n        softDropMax: 20,\r\n        hardDropMax: 40\r\n    },\r\n\r\n    // Draw full shape square (debug)\r\n    drawEmptyTiles: false\r\n};\r\n\r\nexport default settings;\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/settings.ts","import Matrix from '../interfaces/matrix';\r\nimport { ISize } from '../interfaces/size';\r\nimport drawGrid from '../services/draw-grid';\r\nimport drawMatrix from '../services/draw-matrix';\r\nimport { getMatrixSize } from '../services/matrix-calculations';\r\n\r\nexport default class Panel {\r\n    public readonly ctx: CanvasRenderingContext2D;\r\n    public readonly size: ISize;\r\n    public readonly pixelRatio: number;\r\n\r\n    constructor(id: string) {\r\n        const canvas = document.getElementById(id) as HTMLCanvasElement;\r\n        this.pixelRatio = devicePixelRatio || 1;\r\n\r\n        // Read canvas size\r\n        this.size = {\r\n            width: parseInt(canvas.getAttribute('width') as string, 10) * this.pixelRatio,\r\n            height: parseInt(canvas.getAttribute('height') as string, 10) * this.pixelRatio\r\n        };\r\n\r\n        // Fix scaling for small viewports\r\n        if (this.size.width !== canvas.offsetWidth) {\r\n            canvas.setAttribute('width', `${this.size.width}`);\r\n        }\r\n\r\n        if (this.size.height !== canvas.offsetHeight) {\r\n            canvas.setAttribute('height', `${this.size.height}`);\r\n        }\r\n\r\n        // Get drawing context\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) throw new Error('Context not found!');\r\n        this.ctx = ctx;\r\n    }\r\n\r\n    public draw(matrix: Matrix): void {\r\n        this.clear();\r\n        drawGrid(this, getMatrixSize(matrix));\r\n        drawMatrix(this, matrix);\r\n    }\r\n\r\n    private clear(): void {\r\n        this.ctx.clearRect(0, 0, this.size.width, this.size.height);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/components/panel.ts","import Matrix from '../interfaces/matrix';\r\nimport IPoint from '../interfaces/point';\r\nimport { ISize } from '../interfaces/size';\r\nimport { addMatrix, matrixContains, matrixesColliding } from '../services/matrix-calculations';\r\nimport Shape from './shape';\r\n\r\nexport default class Board {\r\n    private _blocks: Matrix;\r\n    public get blocks() { return this._blocks; }\r\n\r\n    public readonly size: ISize;\r\n\r\n    constructor(size: ISize) {\r\n        this.size = size;\r\n        this.clear();\r\n    }\r\n\r\n    public place(shape: Shape, position: IPoint): void {\r\n        addMatrix(this.blocks, shape.blocks, position);\r\n    }\r\n\r\n    public clearFullLines(): number {\r\n        const fullRows = this.getFullLines();\r\n        fullRows.forEach(row => this.deleteRow(row));\r\n        return fullRows.length;\r\n    }\r\n\r\n    private getFullLines(): number[] {\r\n        const rowCount = this._blocks[0].length;\r\n        const incompleteRows = new Array<boolean>(rowCount - 1);\r\n\r\n        rows:\r\n        for (let y = 0; y < rowCount; y++) {\r\n            // tslint:disable-next-line:prefer-for-of\r\n            for (let x = 0; x < this._blocks.length; x++) {\r\n                if (!this._blocks[x][y]) {\r\n                    incompleteRows[y] = true;\r\n                    continue rows;\r\n                }\r\n            }\r\n        }\r\n\r\n        const result: number[] = [];\r\n        for (let row = 0; row < rowCount; row++) {\r\n            if (!incompleteRows[row]) result.push(row);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private deleteRow(row: number): void {\r\n        this._blocks.forEach(col => {\r\n            col.splice(row, 1);\r\n            col.unshift(undefined);\r\n        });\r\n    }\r\n\r\n    public clear(): void {\r\n        this._blocks = [];\r\n        for (let x = 0; x < this.size.width; x++) {\r\n            this._blocks[x] = new Array(this.size.height);\r\n        }\r\n    }\r\n\r\n    public contains(matrix: Matrix, position: IPoint): boolean {\r\n        return matrixContains(this._blocks, matrix, position);\r\n    }\r\n\r\n    public collides(matrix: Matrix, position: IPoint): boolean {\r\n        return !this.contains(matrix, position)\r\n            || matrixesColliding(this.blocks, matrix, position);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/board.ts","import Matrix from '../interfaces/matrix';\r\nimport { rotateMatrix } from '../services/matrix-calculations';\r\n\r\nexport default class Shape {\r\n    private _blocks: Matrix;\r\n    public get blocks() {\r\n        return this._blocks;\r\n    }\r\n\r\n    constructor(blocks: Matrix) {\r\n        this._blocks = blocks;\r\n    }\r\n\r\n    public rotate(reverse = false): void {\r\n        this._blocks = rotateMatrix(this._blocks, reverse);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shape.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Blue;\r\n\r\nexport default class I extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0],\r\n            [0, c, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/i.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Pink;\r\n\r\nexport default class J extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0],\r\n            [0, c, 0],\r\n            [c, c, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/j.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Orange;\r\n\r\nexport default class L extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, 0],\r\n            [0, c, 0],\r\n            [0, c, c]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/l.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Yellow;\r\n\r\nexport default class O extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c],\r\n            [c, c]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/o.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Red;\r\n\r\nexport default class S extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [0, c, c],\r\n            [c, c, 0],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/s.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Purple;\r\n\r\nexport default class T extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c, c],\r\n            [0, c, 0],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/t.ts","import { xyMatrix } from '../../services/matrix-calculations';\r\nimport { Color } from '../color';\r\nimport Shape from '../shape';\r\n\r\nconst c = Color.Green;\r\n\r\nexport default class Z extends Shape {\r\n    constructor() {\r\n        super(xyMatrix([\r\n            [c, c, 0],\r\n            [0, c, c],\r\n            [0, 0, 0]\r\n        ]));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/shapes/z.ts","import IPoint, { clonePoint } from '../interfaces/point';\r\nimport { findAny, findIndex } from '../services/arrays';\r\nimport getRandomShape from '../services/random-shape';\r\nimport Board from './board';\r\nimport Shape from './shape';\r\n\r\nexport default class Player {\r\n    private _shape: Shape;\r\n    public get shape() {\r\n        return this._shape;\r\n    }\r\n\r\n    public position: IPoint;\r\n    private _startingPos: IPoint;\r\n\r\n    public softDropPoints = 0;\r\n\r\n    constructor(startingPosition: IPoint) {\r\n        this._startingPos = startingPosition;\r\n        this.reset();\r\n    }\r\n\r\n    public reset(): void {\r\n        this.position = clonePoint(this._startingPos);\r\n        this._shape = getRandomShape();\r\n    }\r\n\r\n    /**\r\n     * Calculates a position for\r\n     * the player to be fully on the board\r\n     */\r\n    public getContainedPosition(board: Board): IPoint {\r\n        const position = clonePoint(this.position);\r\n\r\n        // Find lowest x value\r\n        const xLow = (findIndex(this._shape.blocks, col => {\r\n            // Column contains a value\r\n            return findAny(col, value => !!value);\r\n        }) as number) + position.x;\r\n\r\n        // Push shape to the right\r\n        if (xLow < 0) {\r\n            position.x += 0 - xLow;\r\n            return position;\r\n        }\r\n\r\n        // Find highest x value\r\n        const xHigh = this._shape.blocks.length -\r\n            (findIndex(this._shape.blocks.reverse(), col => {\r\n                // Column contains a value\r\n                return findAny(col, value => !!value);\r\n            }) as number) + position.x;\r\n\r\n        // Push shape to the left\r\n        if (xHigh > board.blocks.length) {\r\n            position.x -= xHigh - board.blocks.length;\r\n            return position;\r\n        }\r\n\r\n        return position;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/models/player.ts","import Panel from '../components/panel';\r\nimport Board from '../models/board';\r\nimport Player from '../models/player';\r\n\r\nexport const player = new Player({ x: 7, y: 0 });\r\nexport const panel = new Panel('game');\r\nexport const board = new Board({\r\n    width: 16,\r\n    height: 24\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/storage.ts","import { pointEquals } from '../interfaces/point';\r\nimport settings from '../settings';\r\nimport { activateLoop } from './gameloop';\r\nimport { mergeMatrixes } from './matrix-calculations';\r\nimport { addScore } from './player-score';\r\nimport { board, panel, player } from './storage';\r\n\r\nconst handleKeys = () => document.addEventListener('keydown', e => {\r\n\r\n    let newPosition = {\r\n        x: player.position.x,\r\n        y: player.position.y\r\n    };\r\n\r\n    let triggered = true;\r\n    switch (e.code) {\r\n        case 'ArrowUp':\r\n            // Rotate clockwise\r\n            if (e.repeat) return;\r\n            player.shape.rotate();\r\n\r\n            // Push shape back on to the board\r\n            if (!board.contains(player.shape.blocks, newPosition)) {\r\n                newPosition = player.getContainedPosition(board);\r\n            }\r\n\r\n            break;\r\n        case 'ArrowRight':\r\n            // Move right\r\n            newPosition.x++;\r\n            break;\r\n        case 'ArrowDown':\r\n            // Soft drop\r\n            newPosition.y++;\r\n\r\n            // Add points to score\r\n            const sdPoints = settings.points.softDrop;\r\n            player.softDropPoints += sdPoints;\r\n            if (player.softDropPoints < settings.points.softDropMax) {\r\n                addScore(sdPoints);\r\n            }\r\n\r\n            break;\r\n        case 'ArrowLeft':\r\n            // Move left\r\n            newPosition.x--;\r\n            break;\r\n        case 'Space':\r\n            // Hard drop\r\n            let nextPos = newPosition;\r\n            let hdPoints = 0;\r\n\r\n            do {\r\n                nextPos = { x: nextPos.x, y: nextPos.y + 1 };\r\n                hdPoints += settings.points.hardDrop;\r\n            } while (!board.collides(player.shape.blocks, nextPos));\r\n\r\n            newPosition = { x: nextPos.x, y: nextPos.y - 1 };\r\n            addScore(Math.min(\r\n                hdPoints - settings.points.hardDrop,\r\n                settings.points.hardDropMax));\r\n\r\n            break;\r\n        default:\r\n            triggered = false;\r\n            break;\r\n    }\r\n\r\n    const posChanged = !pointEquals(player.position, newPosition);\r\n\r\n    if (posChanged) {\r\n        if (!board.collides(player.shape.blocks, newPosition)) {\r\n            player.position = newPosition;\r\n        } else activateLoop();\r\n    }\r\n\r\n    if (triggered) {\r\n        e.preventDefault();\r\n        const viewMatrix = mergeMatrixes(board.blocks, player.shape.blocks, player.position);\r\n        panel.draw(viewMatrix);\r\n    }\r\n});\r\n\r\nexport default handleKeys;\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/services/key-handling.ts","import loadPlayerScore from './components/player-score';\r\nimport { setLoopSpeed } from './services/gameloop';\r\nimport handleKeys from './services/key-handling';\r\nimport settings from './settings';\r\nimport './vendor/modernizr.min.js';\r\n\r\nsetLoopSpeed(settings.gameSpeed);\r\nhandleKeys();\r\nloadPlayerScore();\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/index.ts","/*! modernizr 3.5.0 (Custom Build) | MIT *\r\n * https://modernizr.com/download/?-canvas-localstorage-serviceworker-sessionstorage-touchevents-webgl !*/\r\n!function(e,t,n){function o(e,t){return typeof e===t}function r(){var e,t,n,r,s,a,i;for(var d in l)if(l.hasOwnProperty(d)){if(e=[],t=l[d],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(r=o(t.fn,\"function\")?t.fn():t.fn,s=0;s<e.length;s++)a=e[s],i=a.split(\".\"),1===i.length?Modernizr[i[0]]=r:(!Modernizr[i[0]]||Modernizr[i[0]]instanceof Boolean||(Modernizr[i[0]]=new Boolean(Modernizr[i[0]])),Modernizr[i[0]][i[1]]=r),c.push((r?\"\":\"no-\")+i.join(\"-\"))}}function s(){return\"function\"!=typeof t.createElement?t.createElement(arguments[0]):u?t.createElementNS.call(t,\"http://www.w3.org/2000/svg\",arguments[0]):t.createElement.apply(t,arguments)}function a(){var e=t.body;return e||(e=s(u?\"svg\":\"body\"),e.fake=!0),e}function i(e,n,o,r){var i,l,d,c,u=\"modernizr\",p=s(\"div\"),v=a();if(parseInt(o,10))for(;o--;)d=s(\"div\"),d.id=r?r[o]:u+(o+1),p.appendChild(d);return i=s(\"style\"),i.type=\"text/css\",i.id=\"s\"+u,(v.fake?v:p).appendChild(i),v.appendChild(p),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),p.id=u,v.fake&&(v.style.background=\"\",v.style.overflow=\"hidden\",c=f.style.overflow,f.style.overflow=\"hidden\",f.appendChild(v)),l=n(p,e),v.fake?(v.parentNode.removeChild(v),f.style.overflow=c,f.offsetHeight):p.parentNode.removeChild(p),!!l}var l=[],d={_version:\"3.5.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){l.push({name:e,fn:t,options:n})},addAsyncTest:function(e){l.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=d,Modernizr=new Modernizr,Modernizr.addTest(\"serviceworker\",\"serviceWorker\"in navigator),Modernizr.addTest(\"localstorage\",function(){var e=\"modernizr\";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}),Modernizr.addTest(\"sessionstorage\",function(){var e=\"modernizr\";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}});var c=[],f=t.documentElement,u=\"svg\"===f.nodeName.toLowerCase();Modernizr.addTest(\"canvas\",function(){var e=s(\"canvas\");return!(!e.getContext||!e.getContext(\"2d\"))}),Modernizr.addTest(\"webgl\",function(){var t=s(\"canvas\"),n=\"probablySupportsContext\"in t?\"probablySupportsContext\":\"supportsContext\";return n in t?t[n](\"webgl\")||t[n](\"experimental-webgl\"):\"WebGLRenderingContext\"in e});var p=d._config.usePrefixes?\" -webkit- -moz- -o- -ms- \".split(\" \"):[\"\",\"\"];d._prefixes=p;var v=d.testStyles=i;Modernizr.addTest(\"touchevents\",function(){var n;if(\"ontouchstart\"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var o=[\"@media (\",p.join(\"touch-enabled),(\"),\"heartz\",\")\",\"{#modernizr{top:9px;position:absolute}}\"].join(\"\");v(o,function(e){n=9===e.offsetTop})}return n}),r(),delete d.addTest,delete d.addAsyncTest;for(var m=0;m<Modernizr._q.length;m++)Modernizr._q[m]();e.Modernizr=Modernizr}(window,document);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/vendor/modernizr.min.js\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}